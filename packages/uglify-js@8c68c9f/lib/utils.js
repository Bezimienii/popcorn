"use strict";function array_to_hash(t){for(var r=Object.create(null),n=0;n<t.length;++n)r[t[n]]=!0;return r}function slice(t,r){return Array.prototype.slice.call(t,r||0)}function characters(t){return t.split("")}function member(t,r){return r.indexOf(t)>=0}function find_if(t,r){for(var n=0,e=r.length;n<e;++n)if(t(r[n]))return r[n]}function repeat_string(t,r){if(r<=0)return"";if(1==r)return t;var n=repeat_string(t,r>>1);return n+=n,1&r&&(n+=t),n}function DefaultsError(t,r){Error.call(this,t),this.msg=t,this.defs=r}function defaults(t,r,n){t===!0&&(t={});var e=t||{};if(n)for(var i in e)HOP(e,i)&&!HOP(r,i)&&DefaultsError.croak("`"+i+"` is not a supported option",r);for(var i in r)HOP(r,i)&&(e[i]=t&&HOP(t,i)?t[i]:r[i]);return e}function merge(t,r){var n=0;for(var e in r)HOP(r,e)&&(t[e]=r[e],n++);return n}function noop(){}function push_uniq(t,r){t.indexOf(r)<0&&t.push(r)}function string_template(t,r){return t.replace(/\{(.+?)\}/g,function(t,n){return r[n]})}function remove(t,r){for(var n=t.length;--n>=0;)t[n]===r&&t.splice(n,1)}function mergeSort(t,r){function n(t,n){for(var e=[],i=0,u=0,s=0;i<t.length&&u<n.length;)r(t[i],n[u])<=0?e[s++]=t[i++]:e[s++]=n[u++];return i<t.length&&e.push.apply(e,t.slice(i)),u<n.length&&e.push.apply(e,n.slice(u)),e}function e(t){if(t.length<=1)return t;var r=Math.floor(t.length/2),i=t.slice(0,r),u=t.slice(r);return i=e(i),u=e(u),n(i,u)}return t.length<2?t.slice():e(t)}function set_difference(t,r){return t.filter(function(t){return r.indexOf(t)<0})}function set_intersection(t,r){return t.filter(function(t){return r.indexOf(t)>=0})}function makePredicate(t){function r(t){if(1==t.length)return n+="return str === "+JSON.stringify(t[0])+";";n+="switch(str){";for(var r=0;r<t.length;++r)n+="case "+JSON.stringify(t[r])+":";n+="return true}return false;"}t instanceof Array||(t=t.split(" "));var n="",e=[];t:for(var i=0;i<t.length;++i){for(var u=0;u<e.length;++u)if(e[u][0].length==t[i].length){e[u].push(t[i]);continue t}e.push([t[i]])}if(e.length>3){e.sort(function(t,r){return r.length-t.length}),n+="switch(str.length){";for(var i=0;i<e.length;++i){var s=e[i];n+="case "+s[0].length+":",r(s)}n+="}"}else r(t);return new Function("str",n)}function all(t,r){for(var n=t.length;--n>=0;)if(!r(t[n]))return!1;return!0}function Dictionary(){this._values=Object.create(null),this._size=0}function HOP(t,r){return Object.prototype.hasOwnProperty.call(t,r)}DefaultsError.prototype=Object.create(Error.prototype),DefaultsError.prototype.constructor=DefaultsError,DefaultsError.croak=function(t,r){throw new DefaultsError(t,r)};var MAP=function(){function t(t,u,s){function o(){var o=u(t[f],f),l=o instanceof e;return l&&(o=o.v),o instanceof r?(o=o.v,o instanceof n?a.push.apply(a,s?o.v.slice().reverse():o.v):a.push(o)):o!==i&&(o instanceof n?c.push.apply(c,s?o.v.slice().reverse():o.v):c.push(o)),l}var f,c=[],a=[];if(t instanceof Array)if(s){for(f=t.length;--f>=0&&!o(););c.reverse(),a.reverse()}else for(f=0;f<t.length&&!o();++f);else for(f in t)if(HOP(t,f)&&o())break;return a.concat(c)}function r(t){this.v=t}function n(t){this.v=t}function e(t){this.v=t}t.at_top=function(t){return new r(t)},t.splice=function(t){return new n(t)},t.last=function(t){return new e(t)};var i=t.skip={};return t}();Dictionary.prototype={set:function(t,r){return this.has(t)||++this._size,this._values["$"+t]=r,this},add:function(t,r){return this.has(t)?this.get(t).push(r):this.set(t,[r]),this},get:function(t){return this._values["$"+t]},del:function(t){return this.has(t)&&(--this._size,delete this._values["$"+t]),this},has:function(t){return"$"+t in this._values},each:function(t){for(var r in this._values)t(this._values[r],r.substr(1))},size:function(){return this._size},map:function(t){var r=[];for(var n in this._values)r.push(t(this._values[n],n.substr(1)));return r},toObject:function(){return this._values}},Dictionary.fromObject=function(t){var r=new Dictionary;return r._size=merge(r._values,t),r};