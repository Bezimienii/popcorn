"use strict";function Sorter(){}function TokenChain(){}Sorter.prototype.sort=function(e,r){r=r||0;for(var t=0,n=this.keys.length;t<n;t++){var o=this.keys[t],i=o.slice(1),s=e.indexOf(i,r);if(s!==-1){do s!==r&&(e.splice(s,1),e.splice(r,0,i)),r++;while((s=e.indexOf(i,r))!==-1);return this[o].sort(e,r)}}return e},TokenChain.prototype={add:function(e){var r=this;e.forEach(function(t){var n="$"+t;r[n]||(r[n]=[],r[n].processed=0),r[n].push(e)})},createSorter:function(){var e=this,r=new Sorter;return r.keys=Object.keys(e).sort(function(r,t){var n=e[r].length,o=e[t].length;return n<o?1:n>o?-1:r<t?-1:r>t?1:0}).filter(function(t){if(e[t].processed<e[t].length){var n=t.slice(1),o=new TokenChain;return e[t].forEach(function(r){for(var t;(t=r.indexOf(n))!==-1;)r.splice(t,1);r.forEach(function(r){e["$"+r].processed++}),o.add(r.slice(0))}),r[t]=o.createSorter(),!0}return!1}),r}},module.exports=TokenChain;