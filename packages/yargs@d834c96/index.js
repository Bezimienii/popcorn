function Argv(e,n){function r(e){var n=Parser(e,s),r=n.argv,c=n.aliases;r.$0=o.$0,o.parsed=n,y&&~r._.indexOf(y)&&(o.showCompletionScript(),d&&process.exit(0));for(var l,b=Object.keys(o.getCommandHandlers()),h=0;void 0!==(l=b[h]);h++)if(~r._.indexOf(l))return o.getCommandHandlers()[l](o.reset()),o.argv;return Object.keys(r).forEach(function(e){if(e===g&&r[e])o.showHelp("log"),d&&process.exit(0);else if(e===f&&r[e])a.showVersion(),d&&process.exit(0);else if(e===m)return void i.getCompletion(function(e){(e||[]).forEach(function(e){console.log(e)}),d&&process.exit(0)})}),u.nonOptionCount(r),u.missingArgumentValue(r),u.requiredArguments(r),p&&u.unknownArguments(r,c),u.customChecks(r,c),u.implications(r),t(r),r}function t(e){Object.keys(s.key).forEach(function(n){"undefined"==typeof e[n]&&(e[n]=void 0)})}e=e||[];var o={},i=null,a=null,u=null;n||(n=process.cwd()),o.$0=process.argv.slice(0,2).map(function(e,r){if(0!==r||!/\b(node|iojs)$/.test(e)){var t=rebase(n,e);return e.match(/^\//)&&t.length<e.length?t:e}}).join(" ").trim(),void 0!==process.env._&&process.argv[1]===process.env._&&(o.$0=process.env._.replace(path.dirname(process.execPath)+"/",""));var s;o.resetOptions=o.reset=function(){return s={array:[],"boolean":[],string:[],narg:{},key:{},alias:{},"default":{},defaultDescription:{},requiresArg:[],count:[],normalize:[],config:[]},a=Usage(o),u=Validation(o,a),i=Completion(o,a),l={},d=!0,p=!1,g=null,f=null,m=null,c={},o.parsed=!1,o},o.resetOptions(),o["boolean"]=function(e){return s["boolean"].push.apply(s["boolean"],[].concat(e)),o},o.array=function(e){return s.array.push.apply(s.array,[].concat(e)),o},o.nargs=function(e,n){return"object"==typeof e?Object.keys(e).forEach(function(n){o.nargs(n,e[n])}):s.narg[e]=n,o},o.normalize=function(e){return s.normalize.push.apply(s.normalize,[].concat(e)),o},o.config=function(e){return s.config.push.apply(s.config,[].concat(e)),o},o.example=function(e,n){return a.example(e,n),o},o.command=function(e,n,r){return a.command(e,n),r&&(c[e]=r),o};var c={};o.getCommandHandlers=function(){return c},o.string=function(e){return s.string.push.apply(s.string,[].concat(e)),o},o["default"]=function(e,n,r){return"object"==typeof e?Object.keys(e).forEach(function(n){o["default"](n,e[n])}):("function"==typeof n&&(r=a.functionDescription(n,r),n=n.call()),s.defaultDescription[e]=r,s["default"][e]=n),o},o.alias=function(e,n){return"object"==typeof e?Object.keys(e).forEach(function(n){o.alias(n,e[n])}):s.alias[e]=(s.alias[e]||[]).concat(n),o},o.count=function(e){return s.count.push.apply(s.count,[].concat(e)),o};var l={};o.demand=o.required=o.require=function(e,n){return"number"==typeof e?(l._||(l._={count:0,msg:null}),l._.count+=e,l._.msg=n):Array.isArray(e)?e.forEach(function(e){o.demand(e,n)}):"string"==typeof n?l[e]={msg:n}:n!==!0&&"undefined"!=typeof n||(l[e]={msg:void 0}),o},o.getDemanded=function(){return l},o.requiresArg=function(e){return s.requiresArg.push.apply(s.requiresArg,[].concat(e)),o},o.implies=function(e,n){return u.implies(e,n),o},o.usage=function(e,n){return n||"object"!=typeof e||(n=e,e=null),a.usage(e),n&&o.options(n),o},o.epilogue=o.epilog=function(e){return a.epilog(e),o},o.fail=function(e){return a.failFn(e),o},o.check=function(e){return u.check(e),o},o.defaults=o["default"],o.describe=function(e,n){return s.key[e]=!0,a.describe(e,n),o},o.parse=function(e){return r(e)},o.option=o.options=function(e,n){if("object"==typeof e)Object.keys(e).forEach(function(n){o.options(n,e[n])});else{assert("object"==typeof n,"second argument to option must be an object"),s.key[e]=!0,n.alias&&o.alias(e,n.alias);var r=n.demand||n.required||n.require;r&&o.demand(e,r),"default"in n&&o["default"](e,n["default"]),"nargs"in n&&o.nargs(e,n.nargs),(n["boolean"]||"boolean"===n.type)&&(o["boolean"](e),n.alias&&o["boolean"](n.alias)),(n.array||"array"===n.type)&&(o.array(e),n.alias&&o.array(n.alias)),(n.string||"string"===n.type)&&(o.string(e),n.alias&&o.string(n.alias)),(n.count||"count"===n.type)&&o.count(e);var t=n.describe||n.description||n.desc;t&&o.describe(e,t),n.requiresArg&&o.requiresArg(e)}return o},o.getOptions=function(){return s},o.wrap=function(e){return a.wrap(e),o};var p=!1;o.strict=function(){return p=!0,o},o.getStrict=function(){return p},o.showHelp=function(n){return o.parsed||r(e),a.showHelp(n),o};var f=null;o.version=function(e,n,r){return f=n||"version",a.version(e),o["boolean"](f),o.describe(f,r||"Show version number"),o};var g=null;o.addHelpOpt=function(e,n){return g=e,o["boolean"](e),o.describe(e,n||"Show help"),o},o.showHelpOnFail=function(e,n){return a.showHelpOnFail(e,n),o};var d=!0;o.exitProcess=function(e){return"boolean"!=typeof e&&(e=!0),d=e,o},o.getExitProcess=function(){return d},o.help=function(){return arguments.length>0?o.addHelpOpt.apply(o,arguments):(o.parsed||r(e),a.help())};var m=null,y=null;return o.completion=function(e,n,r){return"function"==typeof n&&(r=n,n=null),y=e,m=i.completionKey,o.command(y,n||"generate bash completion script"),r&&i.registerFunction(r),o},o.showCompletionScript=function(e){return e=e||o.$0,console.log(i.generateCompletionScript(e)),o},o.getUsageInstance=function(){return a},o.getValidationInstance=function(){return u},o.terminalWidth=function(){return require("window-size").width},Object.defineProperty(o,"argv",{get:function(){var n=null;try{n=r(e)}catch(t){a.fail(t.message)}return n},enumerable:!0}),sigletonify(o),o}function rebase(e,n){return path.relative(e,n)}function sigletonify(e){Object.keys(e).forEach(function(n){"argv"===n?Argv.__defineGetter__(n,e.__lookupGetter__(n)):Argv[n]="function"==typeof e[n]?e[n].bind(e):e[n]})}var assert=require("assert"),path=require("path"),Completion=require("./lib/completion"),Parser=require("./lib/parser"),Usage=require("./lib/usage"),Validation=require("./lib/validation");Argv(process.argv.slice(2));var exports=module.exports=Argv;exports.rebase=rebase;