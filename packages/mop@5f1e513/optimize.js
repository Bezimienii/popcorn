function optimize(o,i){function e(o){var i=Location.toPath(o);return n.read(i)}i=i||{},o=Location.fromPath(o,!0),i.out&&(i.out.log||(i.out.log=noop),i.out.warn||(i.out.warn=noop),i.out.status||(i.out.status=noop),i.out.error||(i.out.error=noop));var n=i.fs||require("q-io/fs");return build(o,{buildLocation:URL.resolve(o,(i.buildLocation||"builds")+"/"),minify:void 0===i.minify||!!i.minify,lint:void 0!==i.lint&&!!i.lint,noCss:void 0!==i.noCss&&!!i.noCss,cssEmbedding:void 0===i.cssEmbedding||!!i.cssEmbedding,delimiter:void 0!==i.delimiter?i.delimiter:"@",out:i.out||spinner,fs:n,read:e,overlays:["browser"],production:!0})}function usage(){console.log("Usage: mop [options] [<application> ...]"),console.log(""),console.log("    -o --optimize 0 to disable optimizations"),console.log("    -l --lint to enable linter warnings"),console.log("    -d --delimiter @ to use a different symbol"),console.log("       --no-css to disable CSS compression"),console.log("       --no-css-embedding to disable embedding of CSS in HTML"),console.log("")}function version(){var o=require("./package.json");console.log(o.title+" version "+o.version)}function main(){var o=require("optimist"),i=o["boolean"](["h","help","v","version","css","css-embedding"])["default"]("optimize","1").alias("o","optimize")["default"]("delimiter","@").alias("d","delimiter")["default"]("css",!0)["default"]("css-embedding",!0).argv;if(i.h||i.help)return usage();if(i.v||i.version)return version();var e=i._.length?i._[0]:".";e=Path.resolve(process.cwd(),e),optimize(e,{buildLocation:i.t||i.target,minify:i.optimize>0,lint:i.l||i.lint,noCss:!i.css,cssEmbedding:i["css-embedding"],delimiter:i.delimiter})}function noop(){}var URL=require("url2"),Path=require("path"),build=require("./lib/build"),spinner=require("./lib/spinner"),Location=require("./lib/location");module.exports=optimize,module===require.main&&main();