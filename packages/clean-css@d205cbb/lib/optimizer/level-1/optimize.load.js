montageDefine("d205cbb","lib/optimizer/level-1/optimize",{dependencies:["./shorten-hex","./shorten-hsl","./shorten-rgb","./sort-selectors","./tidy-rules","./tidy-block","./tidy-at-rule","../hack","../remove-unused","../restore-from-optimizing","../wrap-for-optimizing","../../options/optimization-level","../../tokenizer/token","../../tokenizer/marker","../../utils/format-position","../../utils/split","../../options/rounding-precision"],factory:function(e,t,n){function i(e){return e&&"-"==e[1][0]&&parseFloat(e[1])<0}function r(e){return re.test(e)}function o(e){return ae.test(e)}function a(e){return e.replace(ae,"url(").replace(/\\?\n|\\?\r\n/g,"")}function l(e){var t=e.value;1==t.length&&"none"==t[0][1]&&(t[0][1]="0 0"),1==t.length&&"transparent"==t[0][1]&&(t[0][1]="0 0")}function s(e){var t,n=e.value;3==n.length&&"/"==n[1][1]&&n[0][1]==n[2][1]?t=1:5==n.length&&"/"==n[2][1]&&n[0][1]==n[3][1]&&n[1][1]==n[4][1]?t=2:7==n.length&&"/"==n[3][1]&&n[0][1]==n[4][1]&&n[1][1]==n[5][1]&&n[2][1]==n[6][1]?t=3:9==n.length&&"/"==n[4][1]&&n[0][1]==n[5][1]&&n[1][1]==n[6][1]&&n[2][1]==n[7][1]&&n[3][1]==n[8][1]&&(t=4),t&&(e.value.splice(t),e.dirty=!0)}function c(e,t,n){return t.indexOf("#")===-1&&t.indexOf("rgb")==-1&&t.indexOf("hsl")==-1?T(t):(t=t.replace(/rgb\((\-?\d+),(\-?\d+),(\-?\d+)\)/g,function(e,t,n,i){return I(t,n,i)}).replace(/hsl\((-?\d+),(-?\d+)%?,(-?\d+)%?\)/g,function(e,t,n,i){return S(t,n,i)}).replace(/(^|[^='"])#([0-9a-f]{6})/gi,function(e,t,n,i,r){var o=r[i+e.length];return o&&te.test(o)?e:n[0]==n[1]&&n[2]==n[3]&&n[4]==n[5]?(t+"#"+n[0]+n[2]+n[4]).toLowerCase():(t+"#"+n).toLowerCase()}).replace(/(^|[^='"])#([0-9a-f]{3})/gi,function(e,t,n){return t+"#"+n.toLowerCase()}).replace(/(rgb|rgba|hsl|hsla)\(([^\)]+)\)/g,function(e,t,n){var i=n.split(","),r="hsl"==t&&3==i.length||"hsla"==t&&4==i.length||"rgb"==t&&3==i.length&&n.indexOf("%")>0||"rgba"==t&&4==i.length&&n.indexOf("%")>0;return r?(i[1].indexOf("%")==-1&&(i[1]+="%"),i[2].indexOf("%")==-1&&(i[2]+="%"),t+"("+i.join(",")+")"):e}),n.colors.opacity&&e.indexOf("background")==-1&&(t=t.replace(/(?:rgba|hsla)\(0,0%?,0%?,0\)/g,function(e){return G(t,",").pop().indexOf("gradient(")>-1?e:"transparent"})),T(t))}function u(e){1==e.value.length&&(e.value[0][1]=e.value[0][1].replace(/progid:DXImageTransform\.Microsoft\.(Alpha|Chroma)(\W)/,function(e,t,n){return t.toLowerCase()+n})),e.value[0][1]=e.value[0][1].replace(/,(\S)/g,", $1").replace(/ ?= ?/g,"=")}function p(e,t){var n=e.value[t][1];"normal"==n?n="400":"bold"==n&&(n="700"),e.value[t][1]=n}function g(e){var t,n=e.value;4==n.length&&"0"===n[0][1]&&"0"===n[1][1]&&"0"===n[2][1]&&"0"===n[3][1]&&(t=e.name.indexOf("box-shadow")>-1?2:1),t&&(e.value.splice(t),e.dirty=!0)}function f(e){var t=e.value;1==t.length&&"none"==t[0][1]&&(t[0][1]="0")}function d(e,t,n){return V.test(t)?t.replace(V,function(e,t){var i,r=parseInt(t);return 0===r?e:(n.properties.shorterLengthUnits&&n.units.pt&&3*r%4===0&&(i=3*r/4+"pt"),n.properties.shorterLengthUnits&&n.units.pc&&r%16===0&&(i=r/16+"pc"),n.properties.shorterLengthUnits&&n.units["in"]&&r%96===0&&(i=r/96+"in"),i&&(i=e.substring(0,e.indexOf(t))+i),i&&i.length<e.length?i:e)}):t}function h(e,t,n){return n.enabled&&t.indexOf(".")!==-1?t.replace(n.decimalPointMatcher,"$1$2$3").replace(n.zeroMatcher,function(e,t,i,r){var o=n.units[r].multiplier,a=parseInt(t),l=isNaN(a)?0:a,s=parseFloat(i);return Math.round((l+s)*o)/o+r}):t}function m(e,t){return ee.test(t)?t.replace(ee,function(e,t,n){var i;return"ms"==n?i=parseInt(t)/1e3+"s":"s"==n&&(i=1e3*parseFloat(t)+"ms"),i.length<e.length?i:e}):t}function v(e,t,n){return/^(?:\-moz\-calc|\-webkit\-calc|calc|rgb|hsl|rgba|hsla)\(/.test(t)?t:"flex"==e||"-ms-flex"==e||"-webkit-flex"==e||"flex-basis"==e||"-webkit-flex-basis"==e?t:t.indexOf("%")>0&&("height"==e||"max-height"==e||"width"==e||"max-width"==e)?t:t.replace(n,"$10$2").replace(n,"$10$2")}function x(e,t){return e.indexOf("filter")>-1||t.indexOf(" ")==-1||0===t.indexOf("expression")?t:t.indexOf(Q.SINGLE_QUOTE)>-1||t.indexOf(Q.DOUBLE_QUOTE)>-1?t:(t=t.replace(/\s+/g," "),t.indexOf("calc")>-1&&(t=t.replace(/\) ?\/ ?/g,")/ ")),t.replace(/(\(;?)\s+/g,"$1").replace(/\s+(;?\))/g,"$1").replace(/, /g,","))}function b(e,t){return t.indexOf("0deg")==-1?t:t.replace(/\(0deg\)/g,"(0)")}function O(e,t){return t.indexOf("0")==-1?t:(t.indexOf("-")>-1&&(t=t.replace(/([^\w\d\-]|^)\-0([^\.]|$)/g,"$10$2").replace(/([^\w\d\-]|^)\-0([^\.]|$)/g,"$10$2")),t.replace(/(^|\s)0+([1-9])/g,"$1$2").replace(/(^|\D)\.0+(\D|$)/g,"$10$2").replace(/(^|\D)\.0+(\D|$)/g,"$10$2").replace(/\.([1-9]*)0+(\D|$)/g,function(e,t,n){return(t.length>0?".":"")+t+n}).replace(/(^|\D)0\.(\d)/g,"$1.$2"))}function k(e,t){return"content"==e||e.indexOf("font-feature-settings")>-1||e.indexOf("grid-")>-1?t:oe.test(t)?t.substring(1,t.length-1):t}function $(e){return!/^url\(['"].+['"]\)$/.test(e)||/^url\(['"].*[\*\s\(\)'"].*['"]\)$/.test(e)||/^url\(['"]data:[^;]+;charset/.test(e)?e:e.replace(/["']/g,"")}function w(e,t,n){var i=n(e,t);return void 0===i?t:i===!1?X:i}function y(e,t){var n,z,L,R,U,C,M=t.options,T=M.level[H.One],S=j(e,!0);e:for(var I=0,B=S.length;I<B;I++)if(n=S[I],z=n.name,ne.test(z)||(C=n.all[n.position],t.warnings.push("Invalid property name '"+z+"' at "+Z(C[1][2][0])+". Ignoring."),n.unused=!0),0===n.value.length&&(C=n.all[n.position],t.warnings.push("Empty property '"+z+"' at "+Z(C[1][2][0])+". Ignoring."),n.unused=!0),n.hack&&((n.hack[0]==K.ASTERISK||n.hack[0]==K.UNDERSCORE)&&!M.compatibility.properties.iePrefixHack||n.hack[0]==K.BACKSLASH&&!M.compatibility.properties.ieSuffixHack||n.hack[0]==K.BANG&&!M.compatibility.properties.ieBangHack)&&(n.unused=!0),T.removeNegativePaddings&&0===z.indexOf("padding")&&(i(n.value[0])||i(n.value[1])||i(n.value[2])||i(n.value[3]))&&(n.unused=!0),!M.compatibility.properties.ieFilters&&A(n)&&(n.unused=!0),!n.unused)if(n.block)y(n.value[0][1],t);else if(!le.test(z)){for(var D=0,N=n.value.length;D<N;D++){if(L=n.value[D][0],R=n.value[D][1],U=o(R),L==W.PROPERTY_BLOCK){n.unused=!0,t.warnings.push("Invalid value token at "+Z(R[0][1][2][0])+". Ignoring.");break}if(U&&!t.validator.isUrl(R)){n.unused=!0,t.warnings.push("Broken URL '"+R+"' at "+Z(n.value[D][2][0])+". Ignoring.");break}if(U?(R=T.normalizeUrls?a(R):R,R=M.compatibility.properties.urlQuotes?R:$(R)):r(R)?R=T.removeQuotes?k(z,R):R:(R=T.removeWhitespace?x(z,R):R,R=h(z,R,M.precision),R=d(z,R,M.compatibility),R=T.replaceTimeUnits?m(z,R):R,R=T.replaceZeroUnits?O(z,R):R,M.compatibility.properties.zeroUnits&&(R=b(z,R),R=v(z,R,M.unitsRegexp)),M.compatibility.properties.colors&&(R=c(z,R,M.compatibility))),R=w(z,R,T.transform),R===X){n.unused=!0;continue e}n.value[D][1]=R}T.replaceMultipleZeros&&g(n),"background"==z&&T.optimizeBackground?l(n):0===z.indexOf("border")&&z.indexOf("radius")>0&&T.optimizeBorderRadius?s(n):"filter"==z&&T.optimizeFilter&&M.compatibility.properties.ieFilters?u(n):"font-weight"==z&&T.optimizeFontWeight?p(n,0):"outline"==z&&T.optimizeOutline&&f(n)}P(S),F(S),E(e,M)}function E(e,t){var n,i;for(i=0;i<e.length;i++)n=e[i],n[0]==W.COMMENT&&(z(n,t),0===n[1].length&&(e.splice(i,1),i--))}function z(e,t){return e[1][2]==Q.EXCLAMATION&&("all"==t.level[H.One].specialComments||t.commentsKept<t.level[H.One].specialComments)?void t.commentsKept++:void(e[1]=[])}function L(e){for(var t=!1,n=0,i=e.length;n<i;n++){var r=e[n];r[0]==W.AT_RULE&&q.test(r[1])&&(t||r[1].indexOf(Y)==-1?(e.splice(n,1),n--,i--):(t=!0,e.splice(n,1),e.unshift([W.AT_RULE,r[1].replace(q,Y)])))}}function R(e){var t=["px","em","ex","cm","mm","in","pt","pc","%"],n=["ch","rem","vh","vm","vmax","vmin","vw"];return n.forEach(function(n){e.compatibility.units[n]&&t.push(n)}),new RegExp("(^|\\s|\\(|,)0(?:"+t.join("|")+")(\\W|$)","g")}function U(e){var t,n,i={matcher:null,units:{}},r=[];for(t in e)n=e[t],n!=J&&(i.units[t]={},i.units[t].value=n,i.units[t].multiplier=Math.pow(10,n),r.push(t));return r.length>0&&(i.enabled=!0,i.decimalPointMatcher=new RegExp("(\\d)\\.($|"+r.join("|")+")($|W)","g"),i.zeroMatcher=new RegExp("(\\d*)(\\.\\d+)("+r.join("|")+")","g")),i}function C(e){return ie.test(e[1])}function A(e){var t;return("filter"==e.name||"-ms-filter"==e.name)&&(t=e.value[0][1],t.indexOf("progid")>-1||0===t.indexOf("alpha")||0===t.indexOf("chroma"))}function M(e,t){var n=t.options,i=n.level[H.One],r=n.compatibility.selectors.ie7Hack,o=n.compatibility.selectors.adjacentSpace,a=n.compatibility.properties.spaceAfterClosingBrace,l=n.format,s=!1,c=!1;n.unitsRegexp=n.unitsRegexp||R(n),n.precision=n.precision||U(i.roundingPrecision),n.commentsKept=n.commentsKept||0;for(var u=0,p=e.length;u<p;u++){var g=e[u];switch(g[0]){case W.AT_RULE:g[1]=C(g)&&c?"":g[1],g[1]=i.tidyAtRules?_(g[1]):g[1],s=!0;break;case W.AT_RULE_BLOCK:y(g[2],t),c=!0;break;case W.NESTED_BLOCK:g[1]=i.tidyBlockScopes?N(g[1],a):g[1],M(g[2],t),c=!0;break;case W.COMMENT:z(g,n);break;case W.RULE:g[1]=i.tidySelectors?D(g[1],!r,o,l,t.warnings):g[1],g[1]=g[1].length>1?B(g[1],i.selectorsSortingMethod):g[1],y(g[2],t),c=!0}(g[0]==W.COMMENT&&0===g[1].length||i.removeEmpty&&(0===g[1].length||g[2]&&0===g[2].length))&&(e.splice(u,1),u--,p--)}return i.cleanupCharsets&&s&&L(e),e}var T=e("./shorten-hex"),S=e("./shorten-hsl"),I=e("./shorten-rgb"),B=e("./sort-selectors"),D=e("./tidy-rules"),N=e("./tidy-block"),_=e("./tidy-at-rule"),K=e("../hack"),F=e("../remove-unused"),P=e("../restore-from-optimizing"),j=e("../wrap-for-optimizing").all,H=e("../../options/optimization-level").OptimizationLevel,W=e("../../tokenizer/token"),Q=e("../../tokenizer/marker"),Z=e("../../utils/format-position"),G=e("../../utils/split"),X="ignore-property",Y="@charset",q=new RegExp("^"+Y,"i"),J=e("../../options/rounding-precision").DEFAULT,V=/(?:^|\s|\()(-?\d+)px/,ee=/^(\-?[\d\.]+)(m?s)$/,te=/[0-9a-f]/i,ne=/^(?:\-chrome\-|\-[\w\-]+\w|\w[\w\-]+\w|\-\-\S+)$/,ie=/^@import/i,re=/^('.*'|".*")$/,oe=/^['"][a-zA-Z][a-zA-Z\d\-_]+['"]$/,ae=/^url\(/i,le=/^--\S+$/;n.exports=M}});