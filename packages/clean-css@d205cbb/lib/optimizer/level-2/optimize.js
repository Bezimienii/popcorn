function removeEmpty(e){for(var r=0,t=e.length;r<t;r++){var i=e[r],o=!1;switch(i[0]){case Token.RULE:o=0===i[1].length||0===i[2].length;break;case Token.NESTED_BLOCK:removeEmpty(i[2]),o=0===i[2].length;break;case Token.AT_RULE:o=0===i[1].length;break;case Token.AT_RULE_BLOCK:o=0===i[2].length}o&&(e.splice(r,1),r--,t--)}}function recursivelyOptimizeBlocks(e,r){for(var t=0,i=e.length;t<i;t++){var o=e[t];if(o[0]==Token.NESTED_BLOCK){var u=/@(-moz-|-o-|-webkit-)?keyframes/.test(o[1][0][1]);level2Optimize(o[2],r,!u)}}}function recursivelyOptimizeProperties(e,r){for(var t=0,i=e.length;t<i;t++){var o=e[t];switch(o[0]){case Token.RULE:optimizeProperties(o[2],!0,!0,r);break;case Token.NESTED_BLOCK:recursivelyOptimizeProperties(o[2],r)}}}function level2Optimize(e,r,t){var i,o,u=r.options.level[OptimizationLevel.Two];if(recursivelyOptimizeBlocks(e,r),recursivelyOptimizeProperties(e,r),u.removeDuplicateRules&&removeDuplicates(e,r),u.mergeAdjacentRules&&mergeAdjacent(e,r),u.reduceNonAdjacentRules&&reduceNonAdjacent(e,r),u.mergeNonAdjacentRules&&"body"!=u.mergeNonAdjacentRules&&mergeNonAdjacentBySelector(e,r),u.mergeNonAdjacentRules&&"selector"!=u.mergeNonAdjacentRules&&mergeNonAdjacentByBody(e,r),u.restructureRules&&u.mergeAdjacentRules&&t&&(restructure(e,r),mergeAdjacent(e,r)),u.restructureRules&&!u.mergeAdjacentRules&&t&&restructure(e,r),u.removeDuplicateFontRules&&removeDuplicateFontAtRules(e,r),u.removeDuplicateMediaBlocks&&removeDuplicateMediaQueries(e,r),u.removeUnusedAtRules&&removeUnusedAtRules(e,r),u.mergeMedia)for(i=mergeMediaQueries(e,r),o=i.length-1;o>=0;o--)level2Optimize(i[o][2],r,!1);return u.removeEmpty&&removeEmpty(e),e}var mergeAdjacent=require("./merge-adjacent"),mergeMediaQueries=require("./merge-media-queries"),mergeNonAdjacentByBody=require("./merge-non-adjacent-by-body"),mergeNonAdjacentBySelector=require("./merge-non-adjacent-by-selector"),reduceNonAdjacent=require("./reduce-non-adjacent"),removeDuplicateFontAtRules=require("./remove-duplicate-font-at-rules"),removeDuplicateMediaQueries=require("./remove-duplicate-media-queries"),removeDuplicates=require("./remove-duplicates"),removeUnusedAtRules=require("./remove-unused-at-rules"),restructure=require("./restructure"),optimizeProperties=require("./properties/optimize"),OptimizationLevel=require("../../options/optimization-level").OptimizationLevel,Token=require("../../tokenizer/token");module.exports=level2Optimize;