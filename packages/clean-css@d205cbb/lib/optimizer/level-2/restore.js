function isInheritOnly(e){for(var a=0,l=e.length;a<l;a++){var u=e[a][1];if("inherit"!=u&&u!=Marker.COMMA&&u!=Marker.FORWARD_SLASH)return!1}return!0}function background(e,a,l){function u(e){Array.prototype.unshift.apply(v,e.value)}function r(e){var l=a[e.name];return l.doubleValues&&1==l.defaultValue.length?e.value[0][1]==l.defaultValue[0]&&(!e.value[1]||e.value[1][1]==l.defaultValue[0]):l.doubleValues&&1!=l.defaultValue.length?e.value[0][1]==l.defaultValue[0]&&(e.value[1]?e.value[1][1]:e.value[0][1])==l.defaultValue[1]:e.value[0][1]==l.defaultValue}for(var n,t,o=e.components,v=[],s=o.length-1;s>=0;s--){var p=o[s],f=r(p);if("background-clip"==p.name){var h=o[s-1],i=r(h);n=p.value[0][1]==h.value[0][1],t=!n&&(i&&!f||!i&&!f||!i&&f&&p.value[0][1]!=h.value[0][1]),n?u(h):t&&(u(p),u(h)),s--}else if("background-size"==p.name){var c=o[s-1],m=r(c);n=!m&&f,t=!n&&(m&&!f||!m&&!f),n?u(c):t?(u(p),v.unshift([Token.PROPERTY_VALUE,Marker.FORWARD_SLASH]),u(c)):1==c.value.length&&u(c),s--}else{if(f||a[p.name].multiplexLastOnly&&!l)continue;u(p)}}return 0===v.length&&1==e.value.length&&"0"==e.value[0][1]&&v.push(e.value[0]),0===v.length&&v.push([Token.PROPERTY_VALUE,a[e.name].defaultValue]),isInheritOnly(v)?[v[0]]:v}function borderRadius(e,a){if(e.multiplex){for(var l=shallowClone(e),u=shallowClone(e),r=0;r<4;r++){var n=e.components[r],t=shallowClone(e);t.value=[n.value[0]],l.components.push(t);var o=shallowClone(e);o.value=[n.value[1]||n.value[0]],u.components.push(o)}var v=fourValues(l,a),s=fourValues(u,a);return v.length!=s.length||v[0][1]!=s[0][1]||v.length>1&&v[1][1]!=s[1][1]||v.length>2&&v[2][1]!=s[2][1]||v.length>3&&v[3][1]!=s[3][1]?v.concat([[Token.PROPERTY_VALUE,Marker.FORWARD_SLASH]]).concat(s):v}return fourValues(e,a)}function font(e,a){var l,u=e.components,r=[],n=0,t=0;if(0===e.value[0][1].indexOf(Marker.INTERNAL))return e.value[0][1]=e.value[0][1].substring(Marker.INTERNAL.length),e.value;for(;n<4;)l=u[n],l.value[0][1]!=a[l.name].defaultValue&&Array.prototype.push.apply(r,l.value),n++;for(Array.prototype.push.apply(r,u[n].value),n++,u[n].value[0][1]!=a[u[n].name].defaultValue&&(Array.prototype.push.apply(r,[[Token.PROPERTY_VALUE,Marker.FORWARD_SLASH]]),Array.prototype.push.apply(r,u[n].value)),n++;u[n].value[t];)r.push(u[n].value[t]),u[n].value[t+1]&&r.push([Token.PROPERTY_VALUE,Marker.COMMA]),t++;return isInheritOnly(r)?[r[0]]:r}function fourValues(e){var a=e.components,l=a[0].value[0],u=a[1].value[0],r=a[2].value[0],n=a[3].value[0];return l[1]==u[1]&&l[1]==r[1]&&l[1]==n[1]?[l]:l[1]==r[1]&&u[1]==n[1]?[l,u]:u[1]==n[1]?[l,u,r]:[l,u,r,n]}function multiplex(e){return function(a,l){if(!a.multiplex)return e(a,l,!0);var u,r,n=0,t=[],o={};for(u=0,r=a.components[0].value.length;u<r;u++)a.components[0].value[u][1]==Marker.COMMA&&n++;for(u=0;u<=n;u++){for(var v=shallowClone(a),s=0,p=a.components.length;s<p;s++){var f=a.components[s],h=shallowClone(f);v.components.push(h);for(var i=o[h.name]||0,c=f.value.length;i<c;i++){if(f.value[i][1]==Marker.COMMA){o[h.name]=i+1;break}h.value.push(f.value[i])}}var m=u==n,k=e(v,l,m);Array.prototype.push.apply(t,k),u<n&&t.push([Token.PROPERTY_VALUE,Marker.COMMA])}return t}}function withoutDefaults(e,a){for(var l=e.components,u=[],r=l.length-1;r>=0;r--){var n=l[r],t=a[n.name];n.value[0][1]!=t.defaultValue&&u.unshift(n.value[0])}return 0===u.length&&u.push([Token.PROPERTY_VALUE,a[e.name].defaultValue]),isInheritOnly(u)?[u[0]]:u}var shallowClone=require("./clone").shallow,Token=require("../../tokenizer/token"),Marker=require("../../tokenizer/marker");module.exports={background:background,borderRadius:borderRadius,font:font,fourValues:fourValues,multiplex:multiplex,withoutDefaults:withoutDefaults};