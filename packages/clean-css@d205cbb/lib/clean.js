function minify(e,i,t,r){var o="function"!=typeof t?t:null,n="function"==typeof r?r:"function"==typeof t?t:null,a={stats:{efficiency:0,minifiedSize:0,originalSize:0,startedAt:Date.now(),timeSpent:0},cache:{specificity:{}},errors:[],inlinedStylesheets:[],inputSourceMapTracker:inputSourceMapTracker(),localOnly:!n,options:i,source:null,sourcesContent:{},validator:validator(i.compatibility),warnings:[]};return o&&a.inputSourceMapTracker.track(void 0,o),runner(a.localOnly)(function(){return readSources(e,a,function(e){var i=a.options.sourceMap?serializeStylesAndSourceMap:serializeStyles,t=optimize(e,a),r=i(t,a),o=withMetadata(r,a);return n?n(a.errors.length>0?a.errors:null,o):o})})}function runner(e){return e?function(e){return e()}:process.nextTick}function optimize(e,i){var t;return t=level0Optimize(e,i),t=OptimizationLevel.One in i.options.level?level1Optimize(e,i):e,t=OptimizationLevel.Two in i.options.level?level2Optimize(e,i,!0):t}function withMetadata(e,i){return e.stats=calculateStatsFrom(e.styles,i),e.errors=i.errors,e.inlinedStylesheets=i.inlinedStylesheets,e.warnings=i.warnings,e}function calculateStatsFrom(e,i){var t=Date.now(),r=t-i.stats.startedAt;return delete i.stats.startedAt,i.stats.timeSpent=r,i.stats.efficiency=1-e.length/i.stats.originalSize,i.stats.minifiedSize=e.length,i.stats}var level0Optimize=require("./optimizer/level-0/optimize"),level1Optimize=require("./optimizer/level-1/optimize"),level2Optimize=require("./optimizer/level-2/optimize"),validator=require("./optimizer/validator"),compatibilityFrom=require("./options/compatibility"),fetchFrom=require("./options/fetch"),formatFrom=require("./options/format").formatFrom,inlineFrom=require("./options/inline"),inlineRequestFrom=require("./options/inline-request"),inlineTimeoutFrom=require("./options/inline-timeout"),OptimizationLevel=require("./options/optimization-level").OptimizationLevel,optimizationLevelFrom=require("./options/optimization-level").optimizationLevelFrom,rebaseFrom=require("./options/rebase"),rebaseToFrom=require("./options/rebase-to"),inputSourceMapTracker=require("./reader/input-source-map-tracker"),readSources=require("./reader/read-sources"),serializeStyles=require("./writer/simple"),serializeStylesAndSourceMap=require("./writer/source-maps"),CleanCSS=module.exports=function(e){e=e||{},this.options={compatibility:compatibilityFrom(e.compatibility),fetch:fetchFrom(e.fetch),format:formatFrom(e.format),inline:inlineFrom(e.inline),inlineRequest:inlineRequestFrom(e.inlineRequest),inlineTimeout:inlineTimeoutFrom(e.inlineTimeout),level:optimizationLevelFrom(e.level),rebase:rebaseFrom(e.rebase),rebaseTo:rebaseToFrom(e.rebaseTo),returnPromise:!!e.returnPromise,sourceMap:!!e.sourceMap,sourceMapInlineSources:!!e.sourceMapInlineSources}};CleanCSS.prototype.minify=function(e,i,t){var r=this.options;return r.returnPromise?new Promise(function(t,o){minify(e,r,i,function(e,i){return e?o(e):t(i)})}):minify(e,r,i,t)};