montageDefine("d205cbb","lib/tokenizer/tokenize",{dependencies:["./marker","./token","../utils/format-position"],factory:function(e,E,n){function i(e,E){var n={level:_.BLOCK,position:{source:E.source||void 0,line:1,column:0,index:0}};return l(e,E,n,!1)}function l(e,E,n,i){for(var h,C,r,U,T,A,S,m,c,N,B,g,K,P=[],a=P,M=[],d=[],Y=n.level,j=[],D=[],I=[],x=0,k=!1,b=!1,Q=!1,V=!1,v=!1,W=n.position;W.index<e.length;W.index++){var y=e[W.index];if(A=Y==_.SINGLE_QUOTE||Y==_.DOUBLE_QUOTE,S=y==O.SPACE||y==O.TAB,m=y==O.NEW_LINE_NIX,c=y==O.NEW_LINE_NIX&&e[W.index-1]==O.NEW_LINE_WIN,N=!b&&Y!=_.COMMENT&&!A&&y==O.ASTERISK&&e[W.index-1]==O.FORWARD_SLASH,g=!k&&!A&&y==O.FORWARD_SLASH&&e[W.index-1]==O.ASTERISK,B=Y==_.COMMENT&&g,U=0===D.length?[W.line,W.column,W.source]:U,K)D.push(y);else if(B||Y!=_.COMMENT)if(N&&(Y==_.BLOCK||Y==_.RULE)&&D.length>1)d.push(U),D.push(y),I.push(D.slice(0,D.length-2)),D=D.slice(D.length-2),U=[W.line,W.column-1,W.source],j.push(Y),Y=_.COMMENT;else if(N)j.push(Y),Y=_.COMMENT,D.push(y);else if(B)T=D.join("").trim()+y,h=[u.COMMENT,T,[o(U,T,E)]],a.push(h),Y=j.pop(),U=d.pop()||null,D=I.pop()||[];else if(g&&e[W.index+1]!=O.ASTERISK)E.warnings.push("Unexpected '*/' at "+p([W.line,W.column,W.source])+"."),D=[];else if(y!=O.SINGLE_QUOTE||A)if(y==O.SINGLE_QUOTE&&Y==_.SINGLE_QUOTE)Y=j.pop(),D.push(y);else if(y!=O.DOUBLE_QUOTE||A)if(y==O.DOUBLE_QUOTE&&Y==_.DOUBLE_QUOTE)Y=j.pop(),D.push(y);else if(!N&&!B&&y!=O.CLOSE_ROUND_BRACKET&&y!=O.OPEN_ROUND_BRACKET&&Y!=_.COMMENT&&!A&&x>0)D.push(y);else if(y!=O.OPEN_ROUND_BRACKET||A||Y==_.COMMENT||V)if(y!=O.CLOSE_ROUND_BRACKET||A||Y==_.COMMENT||V)if(y==O.SEMICOLON&&Y==_.BLOCK&&D[0]==O.AT)T=D.join("").trim(),P.push([u.AT_RULE,T,[o(U,T,E)]]),D=[];else if(y==O.COMMA&&Y==_.BLOCK&&C)T=D.join("").trim(),C[1].push([s(C[0]),T,[o(U,T,E,C[1].length)]]),D=[];else if(y==O.COMMA&&Y==_.BLOCK&&t(D)==u.AT_RULE)D.push(y);else if(y==O.COMMA&&Y==_.BLOCK)C=[t(D),[],[]],T=D.join("").trim(),C[1].push([s(C[0]),T,[o(U,T,E,0)]]),D=[];else if(y==O.OPEN_CURLY_BRACKET&&Y==_.BLOCK&&C&&C[0]==u.NESTED_BLOCK)T=D.join("").trim(),C[1].push([u.NESTED_BLOCK_SCOPE,T,[o(U,T,E)]]),P.push(C),j.push(Y),W.column++,W.index++,D=[],C[2]=l(e,E,n,!0),C=null;else if(y==O.OPEN_CURLY_BRACKET&&Y==_.BLOCK&&t(D)==u.NESTED_BLOCK)T=D.join("").trim(),C=C||[u.NESTED_BLOCK,[],[]],C[1].push([u.NESTED_BLOCK_SCOPE,T,[o(U,T,E)]]),P.push(C),j.push(Y),W.column++,W.index++,D=[],C[2]=l(e,E,n,!0),C=null;else if(y==O.OPEN_CURLY_BRACKET&&Y==_.BLOCK)T=D.join("").trim(),C=C||[t(D),[],[]],C[1].push([s(C[0]),T,[o(U,T,E,C[1].length)]]),a=C[2],P.push(C),j.push(Y),Y=_.RULE,D=[];else if(y==O.OPEN_CURLY_BRACKET&&Y==_.RULE&&V)M.push(C),C=[u.PROPERTY_BLOCK,[]],r.push(C),a=C[1],j.push(Y),Y=_.RULE,V=!1;else if(y==O.OPEN_CURLY_BRACKET&&Y==_.RULE&&L(D))T=D.join("").trim(),M.push(C),C=[u.AT_RULE_BLOCK,[],[]],C[1].push([u.AT_RULE_BLOCK_SCOPE,T,[o(U,T,E)]]),a.push(C),a=C[2],j.push(Y),Y=_.RULE,D=[];else if(y!=O.COLON||Y!=_.RULE||V)if(y==O.SEMICOLON&&Y==_.RULE&&r&&M.length>0&&D.length>0&&D[0]==O.AT)T=D.join("").trim(),C[1].push([u.AT_RULE,T,[o(U,T,E)]]),D=[];else if(y==O.SEMICOLON&&Y==_.RULE&&r&&D.length>0)T=D.join("").trim(),r.push([u.PROPERTY_VALUE,T,[o(U,T,E)]]),r=null,V=!1,D=[];else if(y==O.SEMICOLON&&Y==_.RULE&&r&&0===D.length)r=null,V=!1;else if(y==O.SEMICOLON&&Y==_.RULE&&D.length>0&&D[0]==O.AT)T=D.join(""),a.push([u.AT_RULE,T,[o(U,T,E)]]),V=!1,D=[];else if(y==O.SEMICOLON&&Y==_.RULE&&v)v=!1,D=[];else if(y==O.SEMICOLON&&Y==_.RULE&&0===D.length);else if(y==O.CLOSE_CURLY_BRACKET&&Y==_.RULE&&r&&V&&D.length>0&&M.length>0)T=D.join(""),r.push([u.PROPERTY_VALUE,T,[o(U,T,E)]]),r=null,C=M.pop(),a=C[2],Y=j.pop(),V=!1,D=[];else if(y==O.CLOSE_CURLY_BRACKET&&Y==_.RULE&&r&&D.length>0&&D[0]==O.AT&&M.length>0)T=D.join(""),C[1].push([u.AT_RULE,T,[o(U,T,E)]]),r=null,C=M.pop(),a=C[2],Y=j.pop(),V=!1,D=[];else if(y==O.CLOSE_CURLY_BRACKET&&Y==_.RULE&&r&&M.length>0)r=null,C=M.pop(),a=C[2],Y=j.pop(),V=!1;else if(y==O.CLOSE_CURLY_BRACKET&&Y==_.RULE&&r&&D.length>0)T=D.join(""),r.push([u.PROPERTY_VALUE,T,[o(U,T,E)]]),r=null,C=M.pop(),a=P,Y=j.pop(),V=!1,D=[];else if(y==O.CLOSE_CURLY_BRACKET&&Y==_.RULE&&D.length>0&&D[0]==O.AT)r=null,C=null,T=D.join("").trim(),a.push([u.AT_RULE,T,[o(U,T,E)]]),a=P,Y=j.pop(),V=!1,D=[];else if(y==O.CLOSE_CURLY_BRACKET&&Y==_.RULE&&j[j.length-1]==_.RULE)r=null,C=M.pop(),a=C[2],Y=j.pop(),V=!1,v=!0,D=[];else if(y==O.CLOSE_CURLY_BRACKET&&Y==_.RULE)r=null,C=null,a=P,Y=j.pop(),V=!1;else if(y==O.CLOSE_CURLY_BRACKET&&Y==_.BLOCK&&!i&&W.index<=e.length-1)E.warnings.push("Unexpected '}' at "+p([W.line,W.column,W.source])+"."),D.push(y);else{if(y==O.CLOSE_CURLY_BRACKET&&Y==_.BLOCK)break;y==O.OPEN_ROUND_BRACKET&&Y==_.RULE&&V?(D.push(y),x++):y==O.CLOSE_ROUND_BRACKET&&Y==_.RULE&&V&&1==x?(D.push(y),T=D.join("").trim(),r.push([u.PROPERTY_VALUE,T,[o(U,T,E)]]),x--,D=[]):y==O.CLOSE_ROUND_BRACKET&&Y==_.RULE&&V?(D.push(y),x--):y==O.FORWARD_SLASH&&e[W.index+1]!=O.ASTERISK&&Y==_.RULE&&V&&D.length>0?(T=D.join("").trim(),r.push([u.PROPERTY_VALUE,T,[o(U,T,E)]]),r.push([u.PROPERTY_VALUE,y,[[W.line,W.column,W.source]]]),D=[]):y==O.FORWARD_SLASH&&e[W.index+1]!=O.ASTERISK&&Y==_.RULE&&V?(r.push([u.PROPERTY_VALUE,y,[[W.line,W.column,W.source]]]),D=[]):y==O.COMMA&&Y==_.RULE&&V&&D.length>0?(T=D.join("").trim(),r.push([u.PROPERTY_VALUE,T,[o(U,T,E)]]),r.push([u.PROPERTY_VALUE,y,[[W.line,W.column,W.source]]]),D=[]):y==O.COMMA&&Y==_.RULE&&V?(r.push([u.PROPERTY_VALUE,y,[[W.line,W.column,W.source]]]),D=[]):y==O.CLOSE_SQUARE_BRACKET&&r&&r.length>1&&D.length>0&&R(D)?(D.push(y),T=D.join("").trim(),r[r.length-1][1]+=T,D=[]):(S||m&&!c)&&Y==_.RULE&&V&&r&&D.length>0?(T=D.join("").trim(),r.push([u.PROPERTY_VALUE,T,[o(U,T,E)]]),D=[]):c&&Y==_.RULE&&V&&r&&D.length>1?(T=D.join("").trim(),r.push([u.PROPERTY_VALUE,T,[o(U,T,E)]]),D=[]):c&&Y==_.RULE&&V?D=[]:1==D.length&&c?D.pop():(D.length>0||!S&&!m&&!c)&&D.push(y)}else T=D.join("").trim(),r=[u.PROPERTY,[u.PROPERTY_NAME,T,[o(U,T,E)]]],a.push(r),V=!0,D=[];else D.push(y),x--;else D.push(y),x++;else j.push(Y),Y=_.DOUBLE_QUOTE,D.push(y);else j.push(Y),Y=_.SINGLE_QUOTE,D.push(y);else D.push(y);Q=K,K=!Q&&y==O.BACK_SLASH,k=N,b=B,W.line=c||m?W.line+1:W.line,W.column=c||m?0:W.column+1}return V&&E.warnings.push("Missing '}' at "+p([W.line,W.column,W.source])+"."),V&&D.length>0&&(T=D.join("").replace(f,""),r.push([u.PROPERTY_VALUE,T,[o(U,T,E)]]),D=[]),D.length>0&&E.warnings.push("Invalid character(s) '"+D.join("")+"' at "+p(U)+". Ignoring."),P}function o(e,E,n,i){var l=e[2];return n.inputSourceMapTracker.isTracking(l)?n.inputSourceMapTracker.originalPositionFor(e,E.length,i):e}function t(e){var E=e[0]==O.AT||e[0]==O.UNDERSCORE,n=e.join("").split(A)[0];return E&&C.indexOf(n)>-1?u.NESTED_BLOCK:E&&h.indexOf(n)>-1?u.AT_RULE:E?u.AT_RULE_BLOCK:u.RULE}function s(e){return e==u.RULE?u.RULE_SCOPE:e==u.NESTED_BLOCK?u.NESTED_BLOCK_SCOPE:e==u.AT_RULE_BLOCK?u.AT_RULE_BLOCK_SCOPE:void 0}function L(e){var E=e.join("").trim();return r.indexOf(E)>-1||U.indexOf(E)>-1}function R(e){return T.test(e.join("")+O.CLOSE_SQUARE_BRACKET)}var O=e("./marker"),u=e("./token"),p=e("../utils/format-position"),_={BLOCK:"block",COMMENT:"comment",DOUBLE_QUOTE:"double-quote",RULE:"rule",SINGLE_QUOTE:"single-quote"},h=["@charset","@import"],C=["@-moz-document","@document","@-moz-keyframes","@-ms-keyframes","@-o-keyframes","@-webkit-keyframes","@keyframes","@media","@supports"],r=["@bottom-center","@bottom-left","@bottom-left-corner","@bottom-right","@bottom-right-corner","@left-bottom","@left-middle","@left-top","@right-bottom","@right-middle","@right-top","@top-center","@top-left","@top-left-corner","@top-right","@top-right-corner"],U=["@footnote","@footnotes","@left","@page-float-bottom","@page-float-top","@right"],T=/^\[\s*\d+\s*\]$/,A=/[\s\(]/,f=/[\s|\}]*$/;n.exports=i}});