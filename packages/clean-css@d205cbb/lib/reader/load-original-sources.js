function loadOriginalSources(o,e){var n={callback:e,fetch:o.options.fetch,index:0,inline:o.options.inline,inlineRequest:o.options.inlineRequest,inlineTimeout:o.options.inlineTimeout,localOnly:o.localOnly,rebaseTo:o.options.rebaseTo,sourcesContent:o.sourcesContent,uriToSource:uriToSourceMapping(o.inputSourceMapTracker.all()),warnings:o.warnings};return o.options.sourceMap&&o.options.sourceMapInlineSources?doLoadOriginalSources(n):e()}function uriToSourceMapping(o){var e,n,r,i,s,u={};for(r in o)for(e=o[r],i=0,s=e.sources.length;i<s;i++)n=e.sources[i],r=e.sourceContentFor(n,!0),u[n]=r;return u}function doLoadOriginalSources(o){var e,n,r,i=Object.keys(o.uriToSource);for(r=i.length;o.index<r;o.index++){if(e=i[o.index],n=o.uriToSource[e],!n)return loadOriginalSource(e,o);o.sourcesContent[e]=n}return o.callback()}function loadOriginalSource(o,e){var n;return isRemoteResource(o)?loadOriginalSourceFromRemoteUri(o,e,function(n){return e.index++,e.sourcesContent[o]=n,doLoadOriginalSources(e)}):(n=loadOriginalSourceFromLocalUri(o,e),e.index++,e.sourcesContent[o]=n,doLoadOriginalSources(e))}function loadOriginalSourceFromRemoteUri(o,e,n){var r=isAllowedResource(o,!0,e.inline),i=!hasProtocol(o);return e.localOnly?(e.warnings.push('Cannot fetch remote resource from "'+o+'" as no callback given.'),n(null)):i?(e.warnings.push('Cannot fetch "'+o+'" as no protocol given.'),n(null)):r?void e.fetch(o,e.inlineRequest,e.inlineTimeout,function(r,i){r&&e.warnings.push('Missing original source at "'+o+'" - '+r),n(i)}):(e.warnings.push('Cannot fetch "'+o+'" as resource is not allowed.'),n(null))}function loadOriginalSourceFromLocalUri(o,e){var n=isAllowedResource(o,!1,e.inline),r=path.resolve(e.rebaseTo,o);return fs.existsSync(r)&&fs.statSync(r).isFile()?n?fs.readFileSync(r,"utf8"):(e.warnings.push('Cannot fetch "'+r+'" as resource is not allowed.'),null):(e.warnings.push('Ignoring local source map at "'+r+'" as resource is missing.'),null)}var fs=require("fs"),path=require("path"),isAllowedResource=require("./is-allowed-resource"),hasProtocol=require("../utils/has-protocol"),isRemoteResource=require("../utils/is-remote-resource");module.exports=loadOriginalSources;