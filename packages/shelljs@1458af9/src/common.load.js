montageDefine("1458af9","src/common",{dependencies:["os","fs","./ls"],factory:function(r,n,t){function e(){m.silent||console.log.apply(this,arguments)}function o(r,n){if(null===v.error&&(v.error=""),v.error+=v.currentCmd+": "+r+"\n",r.length>0&&e(v.error),m.fatal&&process.exit(1),!n)throw""}function i(r){return r}function c(r,n){n||o("parseOptions() internal error: no map given");var t={};for(var e in n)t[n[e]]=!1;if(!r)return t;"string"!=typeof r&&o("parseOptions() internal error: wrong str");var i=r.match(/^\-(.+)/);if(!i)return t;var c=i[1].split("");return c.forEach(function(r){r in n?t[n[r]]=!0:o("option not recognized: "+r)}),t}function a(r){var n=[];return r.forEach(function(r){if(r.search(/\*[^\/]*\//)>-1||r.search(/\*\*[^\/]*\//)>-1){var t=r.match(/^([^*]+\/|)(.*)/),e=t[1],o=t[2],i=o.replace(/\*\*/g,".*").replace(/\*/g,"[^\\/]*");i=new RegExp(i),g("-R",e).filter(function(r){return i.test(r)}).forEach(function(r){n.push(r)})}else r.search(/\*/)>-1?g("",r).forEach(function(r){n.push(r)}):n.push(r)}),n}function l(r){try{p.unlinkSync(r)}catch(n){if("EPERM"!==n.code)throw n;p.chmodSync(r,"0666"),p.unlinkSync(r)}}function s(){function r(n){if(1===n)return parseInt(16*Math.random(),10).toString(16);for(var t="",e=0;e<n;e++)t+=r(1);return t}return"shelljs_"+r(20)}function f(r){var n=[].slice.call(arguments,1);return n.forEach(function(n){for(var t in n)r[t]=n[t]}),r}function u(r,n,t){return function(){var e=null;v.currentCmd=r,v.error=null;try{var o=[].slice.call(arguments,0);t&&t.notUnix?e=n.apply(this,o):(0!==o.length&&"string"==typeof o[0]&&"-"===o[0][0]||o.unshift(""),e=n.apply(this,o))}catch(i){if(v.error||(console.log("shell.js: internal error"),console.log(i.stack||i),process.exit(1)),m.fatal)throw i}return v.currentCmd="shell.js",e}}var h=r("os"),p=r("fs"),g=r("./ls"),m={silent:!1,fatal:!1};n.config=m;var v={error:null,currentCmd:"shell.js",tempDir:null};n.state=v;var d=h.type().match(/^Win/)?"win":"unix";n.platform=d,n.log=e,n.error=o,n.ShellString=i,n.parseOptions=c,n.expand=a,n.unlinkSync=l,n.randomFileName=s,n.extend=f,n.wrap=u}});