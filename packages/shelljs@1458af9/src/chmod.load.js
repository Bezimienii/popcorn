montageDefine("1458af9","src/chmod",{dependencies:["./common","fs","path"],factory:function(e,E,n){function r(e,E,n){n||(e.length>0&&"-"===e.charAt(0)?(n=E,E=e,e=""):i.error("You must specify a file.")),e=i.parseOptions(e,{R:"recursive",c:"changes",v:"verbose"}),"string"==typeof n&&(n=[n]);var r;e.recursive?(r=[],i.expand(n).forEach(function o(e){var E=c.lstatSync(e);E.isSymbolicLink()||(r.push(e),E.isDirectory()&&c.readdirSync(e).forEach(function(E){o(e+"/"+E)}))})):r=i.expand(n),r.forEach(function(n){if(n=s.resolve(n),c.existsSync(n)||i.error("File not found: "+n),!e.recursive||!c.lstatSync(n).isSymbolicLink()){var r=c.statSync(n).mode,o=r&t.TYPE_MASK,a=r;isNaN(parseInt(E,8))?E.split(",").forEach(function(E){var s=/([ugoa]*)([=\+-])([rwxXst]*)/i,R=s.exec(E);if(R){var f=R[1],T=R[2],I=R[3],O=f.indexOf("u")!=-1||"a"===f||""===f,S=f.indexOf("g")!=-1||"a"===f||""===f,D=f.indexOf("o")!=-1||"a"===f||""===f,d=I.indexOf("r")!=-1,_=I.indexOf("w")!=-1,p=I.indexOf("x")!=-1,y=I.indexOf("t")!=-1,u=I.indexOf("s")!=-1,h=0;switch(O&&(h|=(d?t.OWNER_READ:0)+(_?t.OWNER_WRITE:0)+(p?t.OWNER_EXEC:0)+(u?t.SETUID:0)),S&&(h|=(d?t.GROUP_READ:0)+(_?t.GROUP_WRITE:0)+(p?t.GROUP_EXEC:0)+(u?t.SETGID:0)),D&&(h|=(d?t.OTHER_READ:0)+(_?t.OTHER_WRITE:0)+(p?t.OTHER_EXEC:0)),y&&(h|=t.STICKY),T){case"+":a|=h;break;case"-":a&=~h;break;case"=":a=o+h,c.statSync(n).isDirectory()&&(a|=t.SETUID+t.SETGID&r)}e.verbose&&log(n+" -> "+a.toString(8)),r!=a&&(!e.verbose&&e.changes&&log(n+" -> "+a.toString(8)),c.chmodSync(n,a))}else i.error("Invalid symbolic mode change: "+E)}):(a=o+parseInt(E,8),c.statSync(n).isDirectory()&&(a|=t.SETUID+t.SETGID&r),c.chmodSync(n,a))}})}var i=e("./common"),c=e("fs"),s=e("path"),t=function(e){return{OTHER_EXEC:e.EXEC,OTHER_WRITE:e.WRITE,OTHER_READ:e.READ,GROUP_EXEC:e.EXEC<<3,GROUP_WRITE:e.WRITE<<3,GROUP_READ:e.READ<<3,OWNER_EXEC:e.EXEC<<6,OWNER_WRITE:e.WRITE<<6,OWNER_READ:e.READ<<6,STICKY:parseInt("01000",8),SETGID:parseInt("02000",8),SETUID:parseInt("04000",8),TYPE_MASK:parseInt("0770000",8)}}({EXEC:1,WRITE:2,READ:4});n.exports=r}});