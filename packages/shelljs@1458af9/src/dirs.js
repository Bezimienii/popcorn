function _isStackIndex(r){return/^[\-+]\d+$/.test(r)}function _parseStackIndex(r){if(_isStackIndex(r)){if(Math.abs(r)<_dirStack.length+1)return/^-/.test(r)?Number(r)-1:Number(r);common.error(r+": directory stack index out of range")}else common.error(r+": invalid number")}function _actualDirStack(){return[process.cwd()].concat(_dirStack)}function _pushd(r,e){_isStackIndex(r)&&(e=r,r=""),r=common.parseOptions(r,{n:"no-cd"});var t=_actualDirStack();if("+0"===e)return t;if(e)if(_isStackIndex(e)){var c=_parseStackIndex(e);t=t.slice(c).concat(t.slice(0,c))}else r["no-cd"]?t.splice(1,0,e):t.unshift(e);else{if(!(t.length>1))return common.error("no other directory");t=t.splice(1,1).concat(t)}return r["no-cd"]?t=t.slice(1):(e=path.resolve(t.shift()),_cd("",e)),_dirStack=t,_dirs("")}function _popd(r,e){if(_isStackIndex(r)&&(e=r,r=""),r=common.parseOptions(r,{n:"no-cd"}),!_dirStack.length)return common.error("directory stack empty");if(e=_parseStackIndex(e||"+0"),r["no-cd"]||e>0||_dirStack.length+e===0)e=e>0?e-1:e,_dirStack.splice(e,1);else{var t=path.resolve(_dirStack.shift());_cd("",t)}return _dirs("")}function _dirs(r,e){if(_isStackIndex(r)&&(e=r,r=""),r=common.parseOptions(r,{c:"clear"}),r.clear)return _dirStack=[];var t=_actualDirStack();return e?(e=_parseStackIndex(e),e<0&&(e=t.length+e),common.log(t[e]),t[e]):(common.log(t.join(" ")),t)}var common=require("./common"),_cd=require("./cd"),path=require("path"),_dirStack=[];exports.pushd=_pushd,exports.popd=_popd,exports.dirs=_dirs;