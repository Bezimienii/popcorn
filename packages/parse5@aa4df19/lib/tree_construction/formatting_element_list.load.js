montageDefine("aa4df19","lib/tree_construction/formatting_element_list",{dependencies:[],factory:function(t,e,r){"use strict";var n=3,i=r.exports=function(t){this.length=0,this.entries=[],this.treeAdapter=t,this.bookmark=null};i.MARKER_ENTRY="MARKER_ENTRY",i.ELEMENT_ENTRY="ELEMENT_ENTRY",i.prototype._getNoahArkConditionCandidates=function(t){var e=[];if(this.length>=n)for(var r=this.treeAdapter.getAttrList(t).length,s=this.treeAdapter.getTagName(t),a=this.treeAdapter.getNamespaceURI(t),o=this.length-1;o>=0;o--){var h=this.entries[o];if(h.type===i.MARKER_ENTRY)break;var p=h.element,l=this.treeAdapter.getAttrList(p);this.treeAdapter.getTagName(p)===s&&this.treeAdapter.getNamespaceURI(p)===a&&l.length===r&&e.push({idx:o,attrs:l})}return e.length<n?[]:e},i.prototype._ensureNoahArkCondition=function(t){var e=this._getNoahArkConditionCandidates(t),r=e.length;if(r){for(var i=this.treeAdapter.getAttrList(t),s=i.length,a={},o=0;o<s;o++){var h=i[o];a[h.name]=h.value}for(var o=0;o<s;o++)for(var p=0;p<r;p++){var l=e[p].attrs[o];if(a[l.name]!==l.value&&(e.splice(p,1),r--),e.length<n)return}for(var o=r-1;o>=n-1;o--)this.entries.splice(e[o].idx,1),this.length--}},i.prototype.insertMarker=function(){this.entries.push({type:i.MARKER_ENTRY}),this.length++},i.prototype.pushElement=function(t,e){this._ensureNoahArkCondition(t),this.entries.push({type:i.ELEMENT_ENTRY,element:t,token:e}),this.length++},i.prototype.insertElementAfterBookmark=function(t,e){for(var r=this.length-1;r>=0&&this.entries[r]!==this.bookmark;r--);this.entries.splice(r+1,0,{type:i.ELEMENT_ENTRY,element:t,token:e}),this.length++},i.prototype.removeEntry=function(t){for(var e=this.length-1;e>=0;e--)if(this.entries[e]===t){this.entries.splice(e,1),this.length--;break}},i.prototype.clearToLastMarker=function(){for(;this.length;){var t=this.entries.pop();if(this.length--,t.type===i.MARKER_ENTRY)break}},i.prototype.getElementEntryInScopeWithTagName=function(t){for(var e=this.length-1;e>=0;e--){var r=this.entries[e];if(r.type===i.MARKER_ENTRY)return null;if(this.treeAdapter.getTagName(r.element)===t)return r}return null},i.prototype.getElementEntry=function(t){for(var e=this.length-1;e>=0;e--){var r=this.entries[e];if(r.type===i.ELEMENT_ENTRY&&r.element==t)return r}return null}}});