montageDefine("aa4df19","lib/tree_construction/parser",{dependencies:["../tokenization/tokenizer","./open_element_stack","./formatting_element_list","./doctype","../tree_adapters/default","../common/foreign_content","../common/unicode","../common/html"],factory:function(e,t,n){"use strict";function o(e){var t=mt.getTokenAttr(e,ht.ACTION),n=[];return null!==t&&n.push({name:ht.ACTION,value:t}),n}function r(e){var t=mt.getTokenAttr(e,ht.PROMPT);return null===t?Rt:t}function T(e){for(var t=e.attrs,n=[],o=0;o<t.length;o++){var r=t[o].name;r!==ht.NAME&&r!==ht.ACTION&&r!==ht.PROMPT&&n.push(t[o])}return n.push({name:ht.NAME,value:ut}),n}function s(e,t){}function a(e,t){e._appendCommentNode(t,e.openElements.current)}function E(e,t){e._appendCommentNode(t,e.openElements.items[0])}function i(e,t){e._appendCommentNode(t,e.document)}function p(e,t){e._insertCharacters(t)}function m(e,t){e.stopped=!0}function c(e,t){e._setDocumentType(t),(t.forceQuirks||At.isQuirks(t.name,t.publicId,t.systemId))&&e.treeAdapter.setQuirksMode(e.document),e.insertionMode=Lt}function _(e,t){e.treeAdapter.setQuirksMode(e.document),e.insertionMode=Lt,e._processToken(t)}function A(e,t){t.tagName===dt.HTML?(e._insertElement(t,gt.HTML),e.insertionMode=Ht):O(e,t)}function l(e,t){var n=t.tagName;n!==dt.HTML&&n!==dt.HEAD&&n!==dt.BODY&&n!==dt.BR||O(e,t)}function O(e,t){e._insertFakeRootElement(),e.insertionMode=Ht,e._processToken(t)}function N(e,t){var n=t.tagName;n===dt.HTML?se(e,t):n===dt.HEAD?(e._insertElement(t,gt.HTML),e.headElement=e.openElements.current,e.insertionMode=kt):d(e,t)}function C(e,t){var n=t.tagName;n!==dt.HEAD&&n!==dt.BODY&&n!==dt.HTML&&n!==dt.BR||d(e,t)}function d(e,t){e._processFakeStartTag(dt.HEAD),e._processToken(t)}function g(e,t){var n=t.tagName;n===dt.HTML?se(e,t):n===dt.BASE||n===dt.BASEFONT||n===dt.BGSOUND||n===dt.COMMAND||n===dt.LINK||n===dt.META?e._appendElement(t,gt.HTML):n===dt.TITLE?e._switchToTextParsing(t,mt.RCDATA_STATE):n===dt.NOSCRIPT||n===dt.NOFRAMES||n===dt.STYLE?e._switchToTextParsing(t,mt.RAWTEXT_STATE):n===dt.SCRIPT?(e._insertElement(t,gt.HTML),e.tokenizer.state=mt.SCRIPT_DATA_STATE,e.originalInsertionMode=e.insertionMode,e.insertionMode=St):n!==dt.HEAD&&R(e,t)}function h(e,t){var n=t.tagName;n===dt.HEAD?(e.openElements.pop(),e.insertionMode=It):n!==dt.BODY&&n!==dt.BR&&n!==dt.HTML||R(e,t)}function R(e,t){e._processFakeEndTag(dt.HEAD),e._processToken(t)}function u(e,t){var n=t.tagName;n===dt.HTML?se(e,t):n===dt.BODY?(e._insertElement(t,gt.HTML),e.framesetOk=!1,e.insertionMode=Pt):n===dt.FRAMESET?(e._insertElement(t,gt.HTML),e.insertionMode=xt):n===dt.BASE||n===dt.BASEFONT||n===dt.BGSOUND||n===dt.LINK||n===dt.META||n===dt.NOFRAMES||n===dt.SCRIPT||n===dt.STYLE||n===dt.TITLE?(e.openElements.push(e.headElement),g(e,t),e.openElements.remove(e.headElement)):n!==dt.HEAD&&f(e,t)}function M(e,t){var n=t.tagName;n!==dt.BODY&&n!==dt.HTML&&n!==dt.BR||f(e,t)}function f(e,t){e._processFakeStartTag(dt.BODY),e.framesetOk=!0,e._processToken(t)}function L(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t)}function H(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t),e.framesetOk=!1}function k(e,t){e.treeAdapter.adoptAttributes(e.openElements.items[0],t.attrs)}function I(e,t){var n=e.openElements.tryPeekProperlyNestedBodyElement();n&&(e.framesetOk=!1,e.treeAdapter.adoptAttributes(n,t.attrs))}function P(e,t){var n=e.openElements.tryPeekProperlyNestedBodyElement();e.framesetOk&&n&&(e.treeAdapter.detachNode(n),e.openElements.popAllUpToHtmlElement(),e._insertElement(t,gt.HTML),e.insertionMode=xt)}function S(e,t){e.openElements.hasInButtonScope(dt.P)&&e._closePElement(),e._insertElement(t,gt.HTML)}function F(e,t){e.openElements.hasInButtonScope(dt.P)&&e._closePElement();var n=e.openElements.currentTagName;n!==dt.H1&&n!==dt.H2&&n!==dt.H3&&n!==dt.H4&&n!==dt.H5&&n!==dt.H6||e.openElements.pop(),e._insertElement(t,gt.HTML)}function D(e,t){e.openElements.hasInButtonScope(dt.P)&&e._closePElement(),e._insertElement(t,gt.HTML),e.skipNextNewLine=!0,e.framesetOk=!1}function K(e,t){e.formElement||(e.openElements.hasInButtonScope(dt.P)&&e._closePElement(),e._insertElement(t,gt.HTML),e.formElement=e.openElements.current)}function v(e,t){e.framesetOk=!1;for(var n=e.openElements.stackTop;n>=0;n--){var o=e.openElements.items[n],r=e.treeAdapter.getTagName(o);if(t.tagName===dt.LI&&r===dt.LI||(t.tagName===dt.DD||t.tagName===dt.DT)&&(r===dt.DD||r==dt.DT)){e._processFakeEndTag(r);break}if(r!==dt.ADDRESS&&r!==dt.DIV&&r!==dt.P&&e._isSpecialElement(o))break}e.openElements.hasInButtonScope(dt.P)&&e._closePElement(),e._insertElement(t,gt.HTML)}function B(e,t){e.openElements.hasInButtonScope(dt.P)&&e._closePElement(),e._insertElement(t,gt.HTML),e.tokenizer.state=mt.PLAINTEXT_STATE}function y(e,t){e.openElements.hasInScope(dt.BUTTON)?(e._processFakeEndTag(dt.BUTTON),y(e,t)):(e._reconstructActiveFormattingElements(),e._insertElement(t,gt.HTML),e.framesetOk=!1)}function U(e,t){var n=e.activeFormattingElements.getElementEntryInScopeWithTagName(dt.A);n&&(e._processFakeEndTag(dt.A),e.openElements.remove(n.element),e.activeFormattingElements.removeEntry(n)),e._reconstructActiveFormattingElements(),e._insertElement(t,gt.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function b(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,gt.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function G(e,t){e._reconstructActiveFormattingElements(),e.openElements.hasInScope(dt.NOBR)&&(e._processFakeEndTag(dt.NOBR),e._reconstructActiveFormattingElements()),e._insertElement(t,gt.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function Y(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,gt.HTML),e.activeFormattingElements.insertMarker(),e.framesetOk=!1}function x(e,t){!e.treeAdapter.isQuirksMode(e.document)&&e.openElements.hasInButtonScope(dt.P)&&e._closePElement(),e._insertElement(t,gt.HTML),e.framesetOk=!1,e.insertionMode=Ft}function W(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,gt.HTML),e.framesetOk=!1}function w(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,gt.HTML);var n=mt.getTokenAttr(t,ht.TYPE);n&&n.toLowerCase()===Mt||(e.framesetOk=!1)}function z(e,t){e._appendElement(t,gt.HTML)}function X(e,t){e.openElements.hasInButtonScope(dt.P)&&e._closePElement(),e._appendElement(t,gt.HTML),e.framesetOk=!1}function V(e,t){t.tagName=dt.IMG,W(e,t)}function j(e,t){e.formElement||(e._processFakeStartTagWithAttrs(dt.FORM,o(t)),e._processFakeStartTag(dt.HR),e._processFakeStartTag(dt.LABEL),e.treeAdapter.insertText(e.openElements.current,r(t)),e._processFakeStartTagWithAttrs(dt.INPUT,T(t)),e._processFakeEndTag(dt.LABEL),e._processFakeStartTag(dt.HR),e._processFakeEndTag(dt.FORM))}function Q(e,t){e._insertElement(t,gt.HTML),e.skipNextNewLine=!0,e.tokenizer.state=mt.RCDATA_STATE,e.originalInsertionMode=e.insertionMode,e.framesetOk=!1,e.insertionMode=St}function J(e,t){e.openElements.hasInButtonScope(dt.P)&&e._closePElement(),e._reconstructActiveFormattingElements(),e.framesetOk=!1,e._switchToTextParsing(t,mt.RAWTEXT_STATE)}function q(e,t){e.framesetOk=!1,e._switchToTextParsing(t,mt.RAWTEXT_STATE)}function Z(e,t){e._switchToTextParsing(t,mt.RAWTEXT_STATE)}function $(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,gt.HTML),e.framesetOk=!1,e.insertionMode===Ft||e.insertionMode===Kt||e.insertionMode===Bt||e.insertionMode===yt||e.insertionMode===Ut?e.insertionMode=Gt:e.insertionMode=bt}function ee(e,t){e.openElements.currentTagName===dt.OPTION&&e._processFakeEndTag(dt.OPTION),e._reconstructActiveFormattingElements(),e._insertElement(t,gt.HTML)}function te(e,t){e.openElements.hasInScope(dt.RUBY)&&e.openElements.generateImpliedEndTags(),e._insertElement(t,gt.HTML)}function ne(e,t){e._appendElement(t,gt.HTML)}function oe(e,t){e._reconstructActiveFormattingElements(),Ot.adjustTokenMathMLAttrs(t),Ot.adjustTokenXMLAttrs(t),t.selfClosing?e._appendElement(t,gt.MATHML):e._insertElement(t,gt.MATHML)}function re(e,t){e._reconstructActiveFormattingElements(),Ot.adjustTokenSVGAttrs(t),Ot.adjustTokenXMLAttrs(t),t.selfClosing?e._appendElement(t,gt.SVG):e._insertElement(t,gt.SVG)}function Te(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,gt.HTML)}function se(e,t){var n=t.tagName;switch(n.length){case 1:n===dt.I||n===dt.S||n===dt.B||n===dt.U?b(e,t):n===dt.P?S(e,t):n===dt.A?U(e,t):Te(e,t);break;case 2:n===dt.DL||n===dt.OL||n===dt.UL?S(e,t):n===dt.H1||n===dt.H2||n===dt.H3||n===dt.H4||n===dt.H5||n===dt.H6?F(e,t):n===dt.LI||n===dt.DD||n===dt.DT?v(e,t):n===dt.EM||n===dt.TT?b(e,t):n===dt.BR?W(e,t):n===dt.HR?X(e,t):n===dt.RP||n===dt.RT?te(e,t):n!==dt.TH&&n!==dt.TD&&n!==dt.TR&&Te(e,t);break;case 3:n===dt.DIV||n===dt.DIR||n===dt.NAV?S(e,t):n===dt.PRE?D(e,t):n===dt.BIG?b(e,t):n===dt.IMG||n===dt.WBR?W(e,t):n===dt.XMP?J(e,t):n===dt.SVG?re(e,t):n!==dt.COL&&Te(e,t);break;case 4:n===dt.HTML?k(e,t):n===dt.BASE||n===dt.LINK||n===dt.META?g(e,t):n===dt.BODY?I(e,t):n===dt.MAIN||n===dt.MENU?S(e,t):n===dt.FORM?K(e,t):n===dt.CODE||n===dt.FONT?b(e,t):n===dt.NOBR?G(e,t):n===dt.AREA?W(e,t):n===dt.MATH?oe(e,t):n!==dt.HEAD&&Te(e,t);break;case 5:n===dt.STYLE||n===dt.TITLE?g(e,t):n===dt.ASIDE?S(e,t):n===dt.SMALL?b(e,t):n===dt.TABLE?x(e,t):n===dt.EMBED?W(e,t):n===dt.INPUT?w(e,t):n===dt.PARAM||n===dt.TRACK?z(e,t):n===dt.IMAGE?V(e,t):n!==dt.FRAME&&n!==dt.TBODY&&n!==dt.TFOOT&&n!==dt.THEAD&&Te(e,t);break;case 6:n===dt.SCRIPT?g(e,t):n===dt.CENTER||n===dt.FIGURE||n===dt.FOOTER||n===dt.HEADER||n===dt.HGROUP?S(e,t):n===dt.BUTTON?y(e,t):n===dt.STRIKE||n===dt.STRONG?b(e,t):n===dt.APPLET||n===dt.OBJECT?Y(e,t):n===dt.KEYGEN?W(e,t):n===dt.SOURCE?z(e,t):n===dt.IFRAME?q(e,t):n===dt.SELECT?$(e,t):n===dt.OPTION?ee(e,t):Te(e,t);break;case 7:n===dt.BGSOUND||n===dt.COMMAND?g(e,t):n===dt.DETAILS||n===dt.ADDRESS||n===dt.ARTICLE||n===dt.SECTION||n===dt.SUMMARY?S(e,t):n===dt.LISTING?D(e,t):n===dt.MARQUEE?Y(e,t):n===dt.ISINDEX?j(e,t):n===dt.NOEMBED?Z(e,t):n!==dt.CAPTION&&Te(e,t);break;case 8:n===dt.BASEFONT||n===dt.MENUITEM?ne(e,t):n===dt.FRAMESET?P(e,t):n===dt.FIELDSET?S(e,t):n===dt.TEXTAREA?Q(e,t):n===dt.NOSCRIPT?Z(e,t):n===dt.OPTGROUP?ee(e,t):n!==dt.COLGROUP&&Te(e,t);break;case 9:n===dt.PLAINTEXT?B(e,t):Te(e,t);break;case 10:n===dt.BLOCKQUOTE||n===dt.FIGCAPTION?S(e,t):Te(e,t);break;default:Te(e,t)}}function ae(e,t){e.openElements.hasInScope(dt.BODY)?e.insertionMode=Yt:t.ignored=!0}function Ee(e,t){var n=e._processFakeEndTag(dt.BODY);n.ignored||e._processToken(t)}function ie(e,t){var n=t.tagName;e.openElements.hasInScope(n)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(n))}function pe(e,t){var n=e.formElement;e.formElement=null,n&&e.openElements.hasInScope(dt.FORM)&&(e.openElements.generateImpliedEndTags(),e.openElements.remove(n))}function me(e,t){e.openElements.hasInButtonScope(dt.P)?(e.openElements.generateImpliedEndTagsWithExclusion(dt.P),e.openElements.popUntilTagNamePopped(dt.P)):(e._processFakeStartTag(dt.P),e._processToken(t))}function ce(e,t){e.openElements.hasInListItemScope(dt.LI)&&(e.openElements.generateImpliedEndTagsWithExclusion(dt.LI),e.openElements.popUntilTagNamePopped(dt.LI))}function _e(e,t){var n=t.tagName;e.openElements.hasInScope(n)&&(e.openElements.generateImpliedEndTagsWithExclusion(n),e.openElements.popUntilTagNamePopped(n))}function Ae(e,t){e.openElements.hasNumberedHeaderInScope()&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilNumberedHeaderPopped())}function le(e,t){var n=t.tagName;e.openElements.hasInScope(n)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(n),e.activeFormattingElements.clearToLastMarker())}function Oe(e,t){e._processFakeStartTag(dt.BR)}function Ne(e,t){for(var n=t.tagName,o=e.openElements.stackTop;o>0;o--){var r=e.openElements.items[o];if(e.treeAdapter.getTagName(r)===n){e.openElements.generateImpliedEndTagsWithExclusion(n),e.openElements.popUntilElementPopped(r);break}if(e._isSpecialElement(r))break}}function Ce(e,t){var n=t.tagName;switch(n.length){case 1:n===dt.A||n===dt.B||n===dt.I||n===dt.S||n==dt.U?e._callAdoptionAgency(t):n===dt.P?me(e,t):Ne(e,t);break;case 2:n==dt.DL||n===dt.UL||n===dt.OL?ie(e,t):n===dt.LI?ce(e,t):n===dt.DD||n===dt.DT?_e(e,t):n===dt.H1||n===dt.H2||n===dt.H3||n===dt.H4||n===dt.H5||n===dt.H6?Ae(e,t):n===dt.BR?Oe(e,t):n===dt.EM||n===dt.TT?e._callAdoptionAgency(t):Ne(e,t);break;case 3:n===dt.BIG?e._callAdoptionAgency(t):n===dt.DIR||n===dt.DIV||n===dt.NAV?ie(e,t):Ne(e,t);break;case 4:n===dt.BODY?ae(e,t):n===dt.HTML?Ee(e,t):n===dt.FORM?pe(e,t):n===dt.CODE||n===dt.FONT||n===dt.NOBR?e._callAdoptionAgency(t):n===dt.MAIN||n===dt.MENU?ie(e,t):Ne(e,t);break;case 5:n===dt.ASIDE?ie(e,t):n===dt.SMALL?e._callAdoptionAgency(t):Ne(e,t);break;case 6:n===dt.CENTER||n===dt.FIGURE||n===dt.FOOTER||n===dt.HEADER||n===dt.HGROUP?ie(e,t):n===dt.APPLET||n===dt.OBJECT?le(e,t):n==dt.STRIKE||n===dt.STRONG?e._callAdoptionAgency(t):Ne(e,t);break;case 7:n===dt.ADDRESS||n===dt.ARTICLE||n===dt.DETAILS||n===dt.SECTION||n===dt.SUMMARY?ie(e,t):n===dt.MARQUEE?le(e,t):Ne(e,t);break;case 8:n===dt.FIELDSET?ie(e,t):Ne(e,t);break;case 10:n===dt.BLOCKQUOTE||n===dt.FIGCAPTION?ie(e,t):Ne(e,t);break;default:Ne(e,t)}}function de(e,t){!e.fragmentContext&&e.scriptHandler&&t.tagName===dt.SCRIPT&&e.scriptHandler(e.document,e.openElements.current),e.openElements.pop(),e.insertionMode=e.originalInsertionMode}function ge(e,t){e.openElements.pop(),e.insertionMode=e.originalInsertionMode,e._processToken(t)}function he(e,t){var n=e.openElements.currentTagName;n===dt.TABLE||n===dt.TBODY||n===dt.TFOOT||n===dt.THEAD||n===dt.TR?(e.pendingCharacterTokens=[],e.hasNonWhitespacePendingCharacterToken=!1,e.originalInsertionMode=e.insertionMode,e.insertionMode=Dt,e._processToken(t)):Fe(e,t)}function Re(e,t){e.openElements.clearBackToTableContext(),e.activeFormattingElements.insertMarker(),e._insertElement(t,gt.HTML),e.insertionMode=Kt}function ue(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,gt.HTML),e.insertionMode=vt}function Me(e,t){e._processFakeStartTag(dt.COLGROUP),e._processToken(t)}function fe(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,gt.HTML),e.insertionMode=Bt}function Le(e,t){e._processFakeStartTag(dt.TBODY),e._processToken(t)}function He(e,t){var n=e._processFakeEndTag(dt.TABLE);n.ignored||e._processToken(t)}function ke(e,t){var n=mt.getTokenAttr(t,ht.TYPE);n&&n.toLowerCase()===Mt?e._appendElement(t,gt.HTML):Fe(e,t)}function Ie(e,t){e.formElement||(e._insertElement(t,gt.HTML),e.formElement=e.openElements.current,e.openElements.pop())}function Pe(e,t){var n=t.tagName;switch(n.length){case 2:n===dt.TD||n===dt.TH||n===dt.TR?Le(e,t):Fe(e,t);break;case 3:n===dt.COL?Me(e,t):Fe(e,t);break;case 4:n===dt.FORM?Ie(e,t):Fe(e,t);break;case 5:n===dt.TABLE?He(e,t):n===dt.STYLE?g(e,t):n===dt.TBODY||n===dt.TFOOT||n===dt.THEAD?fe(e,t):n===dt.INPUT?ke(e,t):Fe(e,t);break;case 6:n===dt.SCRIPT?g(e,t):Fe(e,t);break;case 7:n===dt.CAPTION?Re(e,t):Fe(e,t);break;case 8:n===dt.COLGROUP?ue(e,t):Fe(e,t);break;default:Fe(e,t)}}function Se(e,t){var n=t.tagName;n===dt.TABLE?e.openElements.hasInTableScope(dt.TABLE)?(e.openElements.popUntilTagNamePopped(dt.TABLE),e._resetInsertionModeAppropriately()):t.ignored=!0:n!==dt.BODY&&n!==dt.CAPTION&&n!==dt.COL&&n!==dt.COLGROUP&&n!==dt.HTML&&n!==dt.TBODY&&n!==dt.TD&&n!==dt.TFOOT&&n!==dt.TH&&n!==dt.THEAD&&n!==dt.TR&&Fe(e,t)}function Fe(e,t){var n=e.fosterParentingEnabled;e.fosterParentingEnabled=!0,e._processTokenInBodyMode(t),e.fosterParentingEnabled=n}function De(e,t){e.pendingCharacterTokens.push(t)}function Ke(e,t){e.pendingCharacterTokens.push(t),e.hasNonWhitespacePendingCharacterToken=!0}function ve(e,t){if(e.hasNonWhitespacePendingCharacterToken)for(var n=0;n<e.pendingCharacterTokens.length;n++)Fe(e,e.pendingCharacterTokens[n]);else for(var n=0;n<e.pendingCharacterTokens.length;n++)e._insertCharacters(e.pendingCharacterTokens[n]);e.insertionMode=e.originalInsertionMode,e._processToken(t)}function Be(e,t){var n=t.tagName;if(n===dt.CAPTION||n===dt.COL||n===dt.COLGROUP||n===dt.TBODY||n===dt.TD||n===dt.TFOOT||n===dt.TH||n===dt.THEAD||n===dt.TR){var o=e._processFakeEndTag(dt.CAPTION);o.ignored||e._processToken(t)}else se(e,t)}function ye(e,t){var n=t.tagName;if(n===dt.CAPTION)e.openElements.hasInTableScope(dt.CAPTION)?(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(dt.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=Ft):t.ignored=!0;else if(n===dt.TABLE){var o=e._processFakeEndTag(dt.CAPTION);o.ignored||e._processToken(t)}else n!==dt.BODY&&n!==dt.COL&&n!==dt.COLGROUP&&n!==dt.HTML&&n!==dt.TBODY&&n!==dt.TD&&n!==dt.TFOOT&&n!==dt.TH&&n!==dt.THEAD&&n!==dt.TR&&Ce(e,t)}function Ue(e,t){var n=t.tagName;n===dt.HTML?se(e,t):n===dt.COL?e._appendElement(t,gt.HTML):Ge(e,t)}function be(e,t){var n=t.tagName;n===dt.COLGROUP?e.openElements.isRootHtmlElementCurrent()?t.ignored=!0:(e.openElements.pop(),e.insertionMode=Ft):n!==dt.COL&&Ge(e,t)}function Ge(e,t){var n=e._processFakeEndTag(dt.COLGROUP);n.ignored||e._processToken(t)}function Ye(e,t){var n=t.tagName;n===dt.TR?(e.openElements.clearBackToTableBodyContext(),e._insertElement(t,gt.HTML),e.insertionMode=yt):n===dt.TH||n===dt.TD?(e._processFakeStartTag(dt.TR),e._processToken(t)):n===dt.CAPTION||n===dt.COL||n===dt.COLGROUP||n===dt.TBODY||n===dt.TFOOT||n===dt.THEAD?e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e._processFakeEndTag(e.openElements.currentTagName),e._processToken(t)):Pe(e,t)}function xe(e,t){var n=t.tagName;n===dt.TBODY||n===dt.TFOOT||n===dt.THEAD?e.openElements.hasInTableScope(n)&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=Ft):n===dt.TABLE?e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e._processFakeEndTag(e.openElements.currentTagName),e._processToken(t)):(n!==dt.BODY&&n!==dt.CAPTION&&n!==dt.COL&&n!==dt.COLGROUP||n!==dt.HTML&&n!==dt.TD&&n!==dt.TH&&n!==dt.TR)&&Se(e,t)}function We(e,t){var n=t.tagName;if(n===dt.TH||n===dt.TD)e.openElements.clearBackToTableRowContext(),e._insertElement(t,gt.HTML),e.insertionMode=Ut,e.activeFormattingElements.insertMarker();else if(n===dt.CAPTION||n===dt.COL||n===dt.COLGROUP||n===dt.TBODY||n===dt.TFOOT||n===dt.THEAD||n===dt.TR){var o=e._processFakeEndTag(dt.TR);o.ignored||e._processToken(t)}else Pe(e,t)}function we(e,t){var n=t.tagName;if(n===dt.TR)e.openElements.hasInTableScope(dt.TR)?(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=Bt):t.ignored=!0;else if(n===dt.TABLE){var o=e._processFakeEndTag(dt.TR);o.ignored||e._processToken(t)}else n===dt.TBODY||n===dt.TFOOT||n===dt.THEAD?e.openElements.hasInTableScope(n)&&(e._processFakeEndTag(dt.TR),e._processToken(t)):(n!==dt.BODY&&n!==dt.CAPTION&&n!==dt.COL&&n!==dt.COLGROUP||n!==dt.HTML&&n!==dt.TD&&n!==dt.TH)&&Se(e,t)}function ze(e,t){var n=t.tagName;n===dt.CAPTION||n===dt.COL||n===dt.COLGROUP||n===dt.TBODY||n===dt.TD||n===dt.TFOOT||n===dt.TH||n===dt.THEAD||n===dt.TR?(e.openElements.hasInTableScope(dt.TD)||e.openElements.hasInTableScope(dt.TH))&&(e._closeTableCell(),e._processToken(t)):se(e,t)}function Xe(e,t){var n=t.tagName;n===dt.TD||n===dt.TH?e.openElements.hasInTableScope(n)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(n),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=yt):n===dt.TABLE||n===dt.TBODY||n===dt.TFOOT||n===dt.THEAD||n===dt.TR?e.openElements.hasInTableScope(n)&&(e._closeTableCell(),e._processToken(t)):n!==dt.BODY&&n!==dt.CAPTION&&n!==dt.COL&&n!==dt.COLGROUP&&n!==dt.HTML&&Ce(e,t)}function Ve(e,t){var n=t.tagName;n===dt.HTML?se(e,t):n===dt.OPTION?(e.openElements.currentTagName===dt.OPTION&&e._processFakeEndTag(dt.OPTION),e._insertElement(t,gt.HTML)):n===dt.OPTGROUP?(e.openElements.currentTagName===dt.OPTION&&e._processFakeEndTag(dt.OPTION),e.openElements.currentTagName===dt.OPTGROUP&&e._processFakeEndTag(dt.OPTGROUP),e._insertElement(t,gt.HTML)):n===dt.SELECT?e._processFakeEndTag(dt.SELECT):n===dt.INPUT||n===dt.KEYGEN||n===dt.TEXTAREA?e.openElements.hasInSelectScope(dt.SELECT)&&(e._processFakeEndTag(dt.SELECT),e._processToken(t)):n===dt.SCRIPT&&g(e,t)}function je(e,t){var n=t.tagName;if(n===dt.OPTGROUP){var o=e.openElements.items[e.openElements.stackTop-1],r=o&&e.treeAdapter.getTagName(o);e.openElements.currentTagName===dt.OPTION&&r===dt.OPTGROUP&&e._processFakeEndTag(dt.OPTION),e.openElements.currentTagName===dt.OPTGROUP&&e.openElements.pop()}else n===dt.OPTION?e.openElements.currentTagName===dt.OPTION&&e.openElements.pop():n===dt.SELECT&&e.openElements.hasInSelectScope(dt.SELECT)&&(e.openElements.popUntilTagNamePopped(dt.SELECT),e._resetInsertionModeAppropriately())}function Qe(e,t){var n=t.tagName;n===dt.CAPTION||n===dt.TABLE||n===dt.TBODY||n===dt.TFOOT||n===dt.THEAD||n===dt.TR||n===dt.TD||n===dt.TH?(e._processFakeEndTag(dt.SELECT),e._processToken(t)):Ve(e,t)}function Je(e,t){var n=t.tagName;n===dt.CAPTION||n===dt.TABLE||n===dt.TBODY||n===dt.TFOOT||n===dt.THEAD||n===dt.TR||n===dt.TD||n===dt.TH?e.openElements.hasInTableScope(n)&&(e._processFakeEndTag(dt.SELECT),e._processToken(t)):je(e,t)}function qe(e,t){t.tagName===dt.HTML?se(e,t):$e(e,t)}function Ze(e,t){t.tagName===dt.HTML?e.fragmentContext||(e.insertionMode=wt):$e(e,t)}function $e(e,t){e.insertionMode=Pt,e._processToken(t)}function et(e,t){var n=t.tagName;n===dt.HTML?se(e,t):n===dt.FRAMESET?e._insertElement(t,gt.HTML):n===dt.FRAME?e._appendElement(t,gt.HTML):n===dt.NOFRAMES&&g(e,t)}function tt(e,t){t.tagName!==dt.FRAMESET||e.openElements.isRootHtmlElementCurrent()||(e.openElements.pop(),e.fragmentContext||e.openElements.currentTagName===dt.FRAMESET||(e.insertionMode=Wt))}function nt(e,t){var n=t.tagName;n===dt.HTML?se(e,t):n===dt.NOFRAMES&&g(e,t)}function ot(e,t){t.tagName===dt.HTML&&(e.insertionMode=zt)}function rt(e,t){t.tagName===dt.HTML?se(e,t):Tt(e,t)}function Tt(e,t){e.insertionMode=Pt,e._processToken(t)}function st(e,t){var n=t.tagName;n===dt.HTML?se(e,t):n===dt.NOFRAMES&&g(e,t)}function at(e,t){t.chars=Nt.REPLACEMENT_CHARACTER,e._insertCharacters(t)}function Et(e,t){e._insertCharacters(t),e.framesetOk=!1}function it(e,t){if(Ot.causesExit(t)&&!e.fragmentContext){for(;e.treeAdapter.getNamespaceURI(e.openElements.current)!==gt.HTML&&!e._isMathMLTextIntegrationPoint(e.openElements.current)&&!e._isHtmlIntegrationPoint(e.openElements.current);)e.openElements.pop();e._processToken(t)}else{var n=e._getAdjustedCurrentElement(),o=e.treeAdapter.getNamespaceURI(n);o===gt.MATHML?Ot.adjustTokenMathMLAttrs(t):o===gt.SVG&&(Ot.adjustTokenSVGTagName(t),Ot.adjustTokenSVGAttrs(t)),Ot.adjustTokenXMLAttrs(t),t.selfClosing?e._appendElement(t,o):e._insertElement(t,o)}}function pt(e,t){for(var n=e.openElements.stackTop;n>0;n--){var o=e.openElements.items[n];if(e.treeAdapter.getNamespaceURI(o)===gt.HTML){e._processToken(t);break}if(e.treeAdapter.getTagName(o).toLowerCase()===t.tagName){e.openElements.popUntilElementPopped(o);break}}}var mt=e("../tokenization/tokenizer"),ct=e("./open_element_stack"),_t=e("./formatting_element_list"),At=e("./doctype"),lt=e("../tree_adapters/default"),Ot=e("../common/foreign_content"),Nt=e("../common/unicode"),Ct=e("../common/html"),dt=Ct.TAG_NAMES,gt=Ct.NAMESPACES,ht=Ct.ATTRS,Rt="This is a searchable index. Enter search keywords: ",ut="isindex",Mt="hidden",ft="INITIAL_MODE",Lt="BEFORE_HTML_MODE",Ht="BEFORE_HEAD_MODE",kt="IN_HEAD_MODE",It="AFTER_HEAD_MODE",Pt="IN_BODY_MODE",St="TEXT_MODE",Ft="IN_TABLE_MODE",Dt="IN_TABLE_TEXT_MODE",Kt="IN_CAPTION_MODE",vt="IN_COLUMN_GROUP_MODE",Bt="IN_TABLE_BODY_MODE",yt="IN_ROW_MODE",Ut="IN_CELL_MODE",bt="IN_SELECT_MODE",Gt="IN_SELECT_IN_TABLE_MODE",Yt="AFTER_BODY_MODE",xt="IN_FRAMESET_MODE",Wt="AFTER_FRAMESET_MODE",wt="AFTER_AFTER_BODY_MODE",zt="AFTER_AFTER_FRAMESET_MODE",Xt={};Xt[dt.SELECT]=bt,Xt[dt.TR]=yt,Xt[dt.TBODY]=Xt[dt.THEAD]=Xt[dt.TFOOT]=Bt,Xt[dt.CAPTION]=Kt,Xt[dt.COLGROUP]=vt,Xt[dt.TABLE]=Ft,Xt[dt.HEAD]=Xt[dt.BODY]=Pt,Xt[dt.FRAMESET]=xt,Xt[dt.HTML]=Ht;var Vt={};Vt[ft]={},Vt[ft][mt.CHARACTER_TOKEN]=Vt[ft][mt.NULL_CHARACTER_TOKEN]=_,Vt[ft][mt.WHITESPACE_CHARACTER_TOKEN]=s,Vt[ft][mt.COMMENT_TOKEN]=a,Vt[ft][mt.DOCTYPE_TOKEN]=c,Vt[ft][mt.START_TAG_TOKEN]=Vt[ft][mt.END_TAG_TOKEN]=Vt[ft][mt.EOF_TOKEN]=_,Vt[Lt]={},Vt[Lt][mt.CHARACTER_TOKEN]=Vt[Lt][mt.NULL_CHARACTER_TOKEN]=O,Vt[Lt][mt.WHITESPACE_CHARACTER_TOKEN]=s,Vt[Lt][mt.COMMENT_TOKEN]=a,Vt[Lt][mt.DOCTYPE_TOKEN]=s,Vt[Lt][mt.START_TAG_TOKEN]=A,Vt[Lt][mt.END_TAG_TOKEN]=l,Vt[Lt][mt.EOF_TOKEN]=O,Vt[Ht]={},Vt[Ht][mt.CHARACTER_TOKEN]=Vt[Ht][mt.NULL_CHARACTER_TOKEN]=d,Vt[Ht][mt.WHITESPACE_CHARACTER_TOKEN]=s,Vt[Ht][mt.COMMENT_TOKEN]=a,Vt[Ht][mt.DOCTYPE_TOKEN]=s,Vt[Ht][mt.START_TAG_TOKEN]=N,Vt[Ht][mt.END_TAG_TOKEN]=C,Vt[Ht][mt.EOF_TOKEN]=d,Vt[kt]={},Vt[kt][mt.CHARACTER_TOKEN]=Vt[kt][mt.NULL_CHARACTER_TOKEN]=R,Vt[kt][mt.WHITESPACE_CHARACTER_TOKEN]=p,Vt[kt][mt.COMMENT_TOKEN]=a,Vt[kt][mt.DOCTYPE_TOKEN]=s,Vt[kt][mt.START_TAG_TOKEN]=g,Vt[kt][mt.END_TAG_TOKEN]=h,Vt[kt][mt.EOF_TOKEN]=R,Vt[It]={},Vt[It][mt.CHARACTER_TOKEN]=Vt[It][mt.NULL_CHARACTER_TOKEN]=f,Vt[It][mt.WHITESPACE_CHARACTER_TOKEN]=p,Vt[It][mt.COMMENT_TOKEN]=a,Vt[It][mt.DOCTYPE_TOKEN]=s,Vt[It][mt.START_TAG_TOKEN]=u,Vt[It][mt.END_TAG_TOKEN]=M,Vt[It][mt.EOF_TOKEN]=f,Vt[Pt]={},Vt[Pt][mt.CHARACTER_TOKEN]=H,Vt[Pt][mt.NULL_CHARACTER_TOKEN]=s,Vt[Pt][mt.WHITESPACE_CHARACTER_TOKEN]=L,Vt[Pt][mt.COMMENT_TOKEN]=a,Vt[Pt][mt.DOCTYPE_TOKEN]=s,Vt[Pt][mt.START_TAG_TOKEN]=se,Vt[Pt][mt.END_TAG_TOKEN]=Ce,Vt[Pt][mt.EOF_TOKEN]=m,Vt[St]={},Vt[St][mt.CHARACTER_TOKEN]=Vt[St][mt.NULL_CHARACTER_TOKEN]=Vt[St][mt.WHITESPACE_CHARACTER_TOKEN]=p,Vt[St][mt.COMMENT_TOKEN]=Vt[St][mt.DOCTYPE_TOKEN]=Vt[St][mt.START_TAG_TOKEN]=s,Vt[St][mt.END_TAG_TOKEN]=de,Vt[St][mt.EOF_TOKEN]=ge,Vt[Ft]={},Vt[Ft][mt.CHARACTER_TOKEN]=Vt[Ft][mt.NULL_CHARACTER_TOKEN]=Vt[Ft][mt.WHITESPACE_CHARACTER_TOKEN]=he,Vt[Ft][mt.COMMENT_TOKEN]=a,Vt[Ft][mt.DOCTYPE_TOKEN]=s,Vt[Ft][mt.START_TAG_TOKEN]=Pe,Vt[Ft][mt.END_TAG_TOKEN]=Se,Vt[Ft][mt.EOF_TOKEN]=m,Vt[Dt]={},Vt[Dt][mt.CHARACTER_TOKEN]=Ke,Vt[Dt][mt.NULL_CHARACTER_TOKEN]=s,Vt[Dt][mt.WHITESPACE_CHARACTER_TOKEN]=De,Vt[Dt][mt.COMMENT_TOKEN]=Vt[Dt][mt.DOCTYPE_TOKEN]=Vt[Dt][mt.START_TAG_TOKEN]=Vt[Dt][mt.END_TAG_TOKEN]=Vt[Dt][mt.EOF_TOKEN]=ve,Vt[Kt]={},Vt[Kt][mt.CHARACTER_TOKEN]=H,Vt[Kt][mt.NULL_CHARACTER_TOKEN]=s,Vt[Kt][mt.WHITESPACE_CHARACTER_TOKEN]=L,Vt[Kt][mt.COMMENT_TOKEN]=a,Vt[Kt][mt.DOCTYPE_TOKEN]=s,Vt[Kt][mt.START_TAG_TOKEN]=Be,Vt[Kt][mt.END_TAG_TOKEN]=ye,Vt[Kt][mt.EOF_TOKEN]=m,Vt[vt]={},Vt[vt][mt.CHARACTER_TOKEN]=Vt[vt][mt.NULL_CHARACTER_TOKEN]=Ge,Vt[vt][mt.WHITESPACE_CHARACTER_TOKEN]=p,Vt[vt][mt.COMMENT_TOKEN]=a,Vt[vt][mt.DOCTYPE_TOKEN]=s,Vt[vt][mt.START_TAG_TOKEN]=Ue,Vt[vt][mt.END_TAG_TOKEN]=be,Vt[vt][mt.EOF_TOKEN]=m,Vt[Bt]={},Vt[Bt][mt.CHARACTER_TOKEN]=Vt[Bt][mt.NULL_CHARACTER_TOKEN]=Vt[Bt][mt.WHITESPACE_CHARACTER_TOKEN]=he,Vt[Bt][mt.COMMENT_TOKEN]=a,Vt[Bt][mt.DOCTYPE_TOKEN]=s,Vt[Bt][mt.START_TAG_TOKEN]=Ye,Vt[Bt][mt.END_TAG_TOKEN]=xe,Vt[Bt][mt.EOF_TOKEN]=m,Vt[yt]={},Vt[yt][mt.CHARACTER_TOKEN]=Vt[yt][mt.NULL_CHARACTER_TOKEN]=Vt[yt][mt.WHITESPACE_CHARACTER_TOKEN]=he,Vt[yt][mt.COMMENT_TOKEN]=a,Vt[yt][mt.DOCTYPE_TOKEN]=s,Vt[yt][mt.START_TAG_TOKEN]=We,Vt[yt][mt.END_TAG_TOKEN]=we,Vt[yt][mt.EOF_TOKEN]=m,Vt[Ut]={},Vt[Ut][mt.CHARACTER_TOKEN]=H,Vt[Ut][mt.NULL_CHARACTER_TOKEN]=s,Vt[Ut][mt.WHITESPACE_CHARACTER_TOKEN]=L,Vt[Ut][mt.COMMENT_TOKEN]=a,Vt[Ut][mt.DOCTYPE_TOKEN]=s,Vt[Ut][mt.START_TAG_TOKEN]=ze,Vt[Ut][mt.END_TAG_TOKEN]=Xe,Vt[Ut][mt.EOF_TOKEN]=m,Vt[bt]={},Vt[bt][mt.CHARACTER_TOKEN]=p,Vt[bt][mt.NULL_CHARACTER_TOKEN]=s,Vt[bt][mt.WHITESPACE_CHARACTER_TOKEN]=p,Vt[bt][mt.COMMENT_TOKEN]=a,Vt[bt][mt.DOCTYPE_TOKEN]=s,Vt[bt][mt.START_TAG_TOKEN]=Ve,Vt[bt][mt.END_TAG_TOKEN]=je,Vt[bt][mt.EOF_TOKEN]=m,Vt[Gt]={},Vt[Gt][mt.CHARACTER_TOKEN]=p,Vt[Gt][mt.NULL_CHARACTER_TOKEN]=s,Vt[Gt][mt.WHITESPACE_CHARACTER_TOKEN]=p,Vt[Gt][mt.COMMENT_TOKEN]=a,Vt[Gt][mt.DOCTYPE_TOKEN]=s,Vt[Gt][mt.START_TAG_TOKEN]=Qe,Vt[Gt][mt.END_TAG_TOKEN]=Je,Vt[Gt][mt.EOF_TOKEN]=m,Vt[Yt]={},Vt[Yt][mt.CHARACTER_TOKEN]=Vt[Yt][mt.NULL_CHARACTER_TOKEN]=$e,Vt[Yt][mt.WHITESPACE_CHARACTER_TOKEN]=L,Vt[Yt][mt.COMMENT_TOKEN]=E,Vt[Yt][mt.DOCTYPE_TOKEN]=s,Vt[Yt][mt.START_TAG_TOKEN]=qe,Vt[Yt][mt.END_TAG_TOKEN]=Ze,Vt[Yt][mt.EOF_TOKEN]=m,Vt[xt]={},Vt[xt][mt.CHARACTER_TOKEN]=Vt[xt][mt.NULL_CHARACTER_TOKEN]=s,Vt[xt][mt.WHITESPACE_CHARACTER_TOKEN]=p,Vt[xt][mt.COMMENT_TOKEN]=a,Vt[xt][mt.DOCTYPE_TOKEN]=s,Vt[xt][mt.START_TAG_TOKEN]=et,Vt[xt][mt.END_TAG_TOKEN]=tt,Vt[xt][mt.EOF_TOKEN]=m,Vt[Wt]={},Vt[Wt][mt.CHARACTER_TOKEN]=Vt[Wt][mt.NULL_CHARACTER_TOKEN]=s,Vt[Wt][mt.WHITESPACE_CHARACTER_TOKEN]=p,Vt[Wt][mt.COMMENT_TOKEN]=a,Vt[Wt][mt.DOCTYPE_TOKEN]=s,Vt[Wt][mt.START_TAG_TOKEN]=nt,Vt[Wt][mt.END_TAG_TOKEN]=ot,Vt[Wt][mt.EOF_TOKEN]=m,Vt[wt]={},Vt[wt][mt.CHARACTER_TOKEN]=Tt,Vt[wt][mt.NULL_CHARACTER_TOKEN]=Tt,Vt[wt][mt.WHITESPACE_CHARACTER_TOKEN]=L,Vt[wt][mt.COMMENT_TOKEN]=i,Vt[wt][mt.DOCTYPE_TOKEN]=s,Vt[wt][mt.START_TAG_TOKEN]=rt,Vt[wt][mt.END_TAG_TOKEN]=Tt,Vt[wt][mt.EOF_TOKEN]=m,Vt[zt]={},Vt[zt][mt.CHARACTER_TOKEN]=Vt[zt][mt.NULL_CHARACTER_TOKEN]=s,Vt[zt][mt.WHITESPACE_CHARACTER_TOKEN]=L,Vt[zt][mt.COMMENT_TOKEN]=i,Vt[zt][mt.DOCTYPE_TOKEN]=s,Vt[zt][mt.START_TAG_TOKEN]=st,Vt[zt][mt.END_TAG_TOKEN]=s,Vt[zt][mt.EOF_TOKEN]=m;var jt=n.exports=function(e){this.treeAdapter=e||lt,this.scriptHandler=null};jt.prototype.parse=function(e){var t=this.treeAdapter.createDocument();return this._reset(e,t,null),this._runParsingLoop(),t},jt.prototype.parseFragment=function(e,t){t||(t=this.treeAdapter.createElement(dt.DIV,gt.HTML,[]));var n=this.treeAdapter.createElement("documentmock",gt.HTML,[]);this._reset(e,n,t),this._initTokenizerForFragmentParsing(),this._insertFakeRootElement(),this._resetInsertionModeAppropriately(),this._findFormInFragmentContext(),this._runParsingLoop();var o=this.treeAdapter.getFirstChild(n),r=this.treeAdapter.createDocumentFragment();return this._adoptNodes(o,r),r},jt.prototype._reset=function(e,t,n){this.tokenizer=new mt(e),this.stopped=!1,this.insertionMode=ft,this.originalInsertionMode="",this.document=t,this.fragmentContext=n,this.headElement=null,this.formElement=null,this.openElements=new ct(this.document,this.treeAdapter),this.activeFormattingElements=new _t(this.treeAdapter),this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1},jt.prototype._iterateParsingLoop=function(){this._setupTokenizerCDATAMode();var e=this.tokenizer.getNextToken();if(this.skipNextNewLine&&(this.skipNextNewLine=!1,e.type===mt.WHITESPACE_CHARACTER_TOKEN&&"\n"===e.chars[0])){if(1===e.chars.length)return;e.chars=e.chars.substr(1)}this._shouldProcessTokenInForeignContent(e)?this._processTokenInForeignContent(e):this._processToken(e)},jt.prototype._runParsingLoop=function(){for(;!this.stopped;)this._iterateParsingLoop()},jt.prototype._setupTokenizerCDATAMode=function(){var e=this._getAdjustedCurrentElement();this.tokenizer.allowCDATA=e&&e!==this.document&&this.treeAdapter.getNamespaceURI(e)!==gt.HTML&&!this._isHtmlIntegrationPoint(e)&&!this._isMathMLTextIntegrationPoint(e)},jt.prototype._switchToTextParsing=function(e,t){this._insertElement(e,gt.HTML),this.tokenizer.state=t,this.originalInsertionMode=this.insertionMode,this.insertionMode=St},jt.prototype._getAdjustedCurrentElement=function(){return 0===this.openElements.stackTop&&this.fragmentContext?this.fragmentContext:this.openElements.current},jt.prototype._findFormInFragmentContext=function(){var e=this.fragmentContext;do{if(this.treeAdapter.getTagName(e)===dt.FORM){this.formElement=e;break}e=this.treeAdapter.getParentNode(e)}while(e)},jt.prototype._initTokenizerForFragmentParsing=function(){var e=this.treeAdapter.getTagName(this.fragmentContext);e===dt.TITLE||e===dt.TEXTAREA?this.tokenizer.state=mt.RCDATA_STATE:e===dt.STYLE||e===dt.XMP||e===dt.IFRAME||e===dt.NOEMBED||e===dt.NOFRAMES||e===dt.NOSCRIPT?this.tokenizer.state=mt.RAWTEXT_STATE:e===dt.SCRIPT?this.tokenizer.state=mt.SCRIPT_DATA_STATE:e===dt.PLAINTEXT&&(this.tokenizer.state=mt.PLAINTEXT_STATE);
},jt.prototype._setDocumentType=function(e){this.treeAdapter.setDocumentType(this.document,e.name,e.publicId,e.systemId)},jt.prototype._attachElementToTree=function(e){this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.current)?this._fosterParentElement(e):this.treeAdapter.appendChild(this.openElements.current,e)},jt.prototype._appendElement=function(e,t){var n=this.treeAdapter.createElement(e.tagName,t,e.attrs);this._attachElementToTree(n)},jt.prototype._insertElement=function(e,t){var n=this.treeAdapter.createElement(e.tagName,t,e.attrs);this._attachElementToTree(n),this.openElements.push(n)},jt.prototype._insertFakeRootElement=function(){var e=this.treeAdapter.createElement(dt.HTML,gt.HTML,[]);this.treeAdapter.appendChild(this.openElements.current,e),this.openElements.push(e)},jt.prototype._appendCommentNode=function(e,t){var n=this.treeAdapter.createCommentNode(e.data);this.treeAdapter.appendChild(t,n)},jt.prototype._insertCharacters=function(e){if(this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.current)){var t=this._findFosterParentingLocation();t.beforeElement?this.treeAdapter.insertTextBefore(t.parent,e.chars,t.beforeElement):this.treeAdapter.insertText(t.parent,e.chars)}else this.treeAdapter.insertText(this.openElements.current,e.chars)},jt.prototype._adoptNodes=function(e,t){for(;;){var n=this.treeAdapter.getFirstChild(e);if(!n)break;this.treeAdapter.detachNode(n),this.treeAdapter.appendChild(t,n)}},jt.prototype._shouldProcessTokenInForeignContent=function(e){var t=this._getAdjustedCurrentElement();if(!t||t===this.document)return!1;var n=this.treeAdapter.getNamespaceURI(t);if(n===gt.HTML)return!1;if(this.treeAdapter.getTagName(t)===dt.ANNOTATION_XML&&n===gt.MATHML&&e.type===mt.START_TAG_TOKEN&&e.tagName===dt.SVG)return!1;var o=e.type===mt.CHARACTER_TOKEN||e.type===mt.NULL_CHARACTER_TOKEN||e.type===mt.WHITESPACE_CHARACTER_TOKEN,r=e.type===mt.START_TAG_TOKEN&&e.tagName!==dt.MGLYPH&&e.tagName!==dt.MALIGNMARK;return(!r&&!o||!this._isMathMLTextIntegrationPoint(t))&&((e.type!==mt.START_TAG_TOKEN&&!o||!this._isHtmlIntegrationPoint(t))&&e.type!==mt.EOF_TOKEN)},jt.prototype._processToken=function(e){Vt[this.insertionMode][e.type](this,e)},jt.prototype._processTokenInBodyMode=function(e){Vt[Pt][e.type](this,e)},jt.prototype._processTokenInForeignContent=function(e){e.type===mt.CHARACTER_TOKEN?Et(this,e):e.type===mt.NULL_CHARACTER_TOKEN?at(this,e):e.type===mt.WHITESPACE_CHARACTER_TOKEN?p(this,e):e.type===mt.COMMENT_TOKEN?a(this,e):e.type===mt.START_TAG_TOKEN?it(this,e):e.type===mt.END_TAG_TOKEN&&pt(this,e)},jt.prototype._processFakeStartTagWithAttrs=function(e,t){var n=this.tokenizer.buildStartTagToken(e);n.attrs=t,this._processToken(n)},jt.prototype._processFakeStartTag=function(e){var t=this.tokenizer.buildStartTagToken(e);return this._processToken(t),t},jt.prototype._processFakeEndTag=function(e){var t=this.tokenizer.buildEndTagToken(e);return this._processToken(t),t},jt.prototype._isMathMLTextIntegrationPoint=function(e){var t=this.treeAdapter.getTagName(e),n=this.treeAdapter.getNamespaceURI(e);return Ot.isMathMLTextIntegrationPoint(t,n)},jt.prototype._isHtmlIntegrationPoint=function(e){var t=this.treeAdapter.getTagName(e),n=this.treeAdapter.getNamespaceURI(e),o=this.treeAdapter.getAttrList(e);return Ot.isHtmlIntegrationPoint(t,n,o)},jt.prototype._reconstructActiveFormattingElements=function(){var e=this.activeFormattingElements.length;if(e){var t=e,n=null;do if(t--,n=this.activeFormattingElements.entries[t],n.type===_t.MARKER_ENTRY||this.openElements.contains(n.element)){t++;break}while(t>0);for(var o=t;o<e;o++)n=this.activeFormattingElements.entries[o],this._insertElement(n.token,this.treeAdapter.getNamespaceURI(n.element)),n.element=this.openElements.current}},jt.prototype._closeTableCell=function(){this.openElements.hasInTableScope(dt.TD)?this._processFakeEndTag(dt.TD):this._processFakeEndTag(dt.TH)},jt.prototype._closePElement=function(){this.openElements.generateImpliedEndTagsWithExclusion(dt.P),this.openElements.popUntilTagNamePopped(dt.P)},jt.prototype._resetInsertionModeAppropriately=function(){for(var e=this.openElements.stackTop,t=!1;e>=0;e--){var n=this.openElements.items[e];this.openElements.items[0]===n&&(t=!0,n=this.fragmentContext);var o=this.treeAdapter.getTagName(n),r=Xt[o];if(r){this.insertionMode=r;break}if(!(t||o!==dt.TD&&o!==dt.TH)){this.insertionMode=Ut;break}if(t){this.insertionMode=Pt;break}}},jt.prototype._obtainFormattingElementEntryForAdoptionAgency=function(e){var t=e.tagName,n=this.activeFormattingElements.getElementEntryInScopeWithTagName(t);return n?this.openElements.contains(n.element)?this.openElements.hasInScope(t)||(n=null):(this.activeFormattingElements.removeEntry(n),n=null):Ne(this,e),n},jt.prototype._obtainFurthestBlockForAdoptionAgency=function(e){for(var t=null,n=this.openElements.stackTop;n>=0;n--){var o=this.openElements.items[n];if(o===e.element)break;this._isSpecialElement(o)&&(t=o)}return t||(this.openElements.popUntilElementPopped(e.element),this.activeFormattingElements.removeEntry(e)),t},jt.prototype._recreateElementForAdoptionAgency=function(e){var t=this.treeAdapter.getNamespaceURI(e.element),n=this.treeAdapter.createElement(e.token.tagName,t,e.token.attrs);return this.openElements.replace(e.element,n),e.element=n,n},jt.prototype._adoptionAgencyInnerLoop=function(e,t){for(var n=null,o=e,r=this.openElements.getCommonAncestor(e),T=0;T<3;T++){n=r,r=this.openElements.getCommonAncestor(n);var s=this.activeFormattingElements.getElementEntry(n);if(s){if(n===t)break;n=this._recreateElementForAdoptionAgency(s),o===e&&(this.activeFormattingElements.bookmark=s),this.treeAdapter.detachNode(o),this.treeAdapter.appendChild(n,o),o=n}else this.openElements.remove(n)}return o},jt.prototype._replaceFormattingElementForAdoptionAgency=function(e,t){var n=this.treeAdapter.getNamespaceURI(t.element),o=t.token,r=this.treeAdapter.createElement(o.tagName,n,o.attrs);this._adoptNodes(e,r),this.treeAdapter.appendChild(e,r),this.activeFormattingElements.insertElementAfterBookmark(r,t.token),this.activeFormattingElements.removeEntry(t),this.openElements.remove(t.element),this.openElements.insertAfter(e,r)},jt.prototype._callAdoptionAgency=function(e){for(var t=0;t<8;t++){var n=this._obtainFormattingElementEntryForAdoptionAgency(e);if(!n)break;var o=this._obtainFurthestBlockForAdoptionAgency(n);if(!o)break;this.activeFormattingElements.bookmark=n;var r=this._adoptionAgencyInnerLoop(o,n.element),T=this.openElements.getCommonAncestor(n.element);this.treeAdapter.detachNode(r),this._isElementCausesFosterParenting(T)?this._fosterParentElement(r):this.treeAdapter.appendChild(T,r),this._replaceFormattingElementForAdoptionAgency(o,n)}},jt.prototype._isElementCausesFosterParenting=function(e){var t=this.treeAdapter.getTagName(e);return t===dt.TABLE||t===dt.TBODY||t===dt.TFOOT||t==dt.THEAD||t===dt.TR},jt.prototype._findFosterParentingLocation=function(){for(var e={parent:null,beforeElement:null},t=this.openElements.stackTop;t>=0;t--){var n=this.openElements.items[t];if(this.treeAdapter.getTagName(n)===dt.TABLE){e.parent=this.treeAdapter.getParentNode(n),e.parent?e.beforeElement=n:e.parent=this.openElements.items[t-1];break}}return e.parent||(e.parent=this.openElements.items[0]),e},jt.prototype._fosterParentElement=function(e){var t=this._findFosterParentingLocation();t.beforeElement?this.treeAdapter.insertBefore(t.parent,e,t.beforeElement):this.treeAdapter.appendChild(t.parent,e)},jt.prototype._isSpecialElement=function(e){var t=this.treeAdapter.getTagName(e),n=this.treeAdapter.getNamespaceURI(e);return Ct.SPECIAL_ELEMENTS[n][t]}}});